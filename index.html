<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namaste AI - Your Cultural Learning Journey</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.botpress.cloud/webchat/v3.0/inject.js"></script>
    <script src="https://files.bpcontent.cloud/2025/06/28/15/20250628152829-Q1WS8S6R.js"></script>
    <!-- Updated Font Imports (from both files) -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&family=Lora:wght@400;700&family=Merriweather:wght@400;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- General Variables & Base Styles --- */
        :root {
            --primary-brown: #CD853F; /* Sienna */
            --dark-saddle-brown: #8B4513; /* SaddleBrown */
            --crimson-red: #DC143C;
            --firebrick-red: #B22222;
            --gold: #FFD700;
            --light-cream: #FDF5E6;
            --pale-goldenrod: #EEE8AA;

            /* Itihaas Reimagined specific colors */
            --deep-brown: #4B3621;
            --muted-maroon: #800000; /* A dark red-brown */
            --warm-black: #2A2A2A;
            --parchment-background: #F8F0E3; /* Light, aged paper */
            --parchment-border: #D4C1A8; /* Slightly darker parchment for borders */
            --text-on-parchment: #5C4B3C; /* Darker brown for readability */

            /* Sanskriti Sync specific colors (integrated) */
            --sanskriti-light-brown: #FDF5E6;
            --sanskriti-medium-brown: #CD853F;
            --sanskriti-dark-brown: #8B4513;
            --sanskriti-gold: #FFD700;
            --sanskriti-soft-gold: #FFEFD5;
            --sanskriti-button-gradient-start: #CD853F;
            --sanskriti-button-gradient-end: #A0522D;
            --sanskriti-selected-gradient-start: #FFD700;
            --sanskriti-selected-gradient-end: #DAA520;
            --sanskriti-text-color: #333;
            --sanskriti-light-text-color: #696969;
            --sanskriti-card-background: #FFF;
            --sanskriti-nav-button-bg: #D2B48C;
            --sanskriti-nav-button-hover: #C3A076;

            /* Landing Page Specific Colors */
            --landing-bg-start: #FCEBDC; /* Very light, warm peach */
            --landing-bg-end: #EADDCB; /* Slightly darker, muted tan */
            --landing-text-dark: #6F4F2A; /* Darker brown for main text */
            --landing-text-medium: #A08569; /* Medium brown for softer text */
            --landing-feature-card-bg: rgba(255, 255, 255, 0.7);
            --landing-feature-card-border: rgba(200, 180, 160, 0.5);

            /* Auth Page Specific Colors */
            --auth-page-bg-start: #FDF0D5;
            --auth-page-bg-end: #EEDDBB;

            /* Splash Screen Specific Colors */
            --splash-bg-start: #F8EDD7; /* Soft cream */
            --splash-bg-end: #DAB88B; /* Muted brown-gold */
            --splash-title-color: #5C4B3C; /* Deep brown */
            --splash-subtitle-color: #7A634E; /* Medium brown */

            /* NEW: Past Patra Specific Colors */
            --patra-bg-light: #FBF8F0; /* Off-white, like paper */
            --patra-bg-dark: #E9DBC7; /* Light brown/beige */
            --patra-text-color: #4A4A4A;
            --patra-heading-color: #6F4F2A; /* Darker brown */
            --patra-button-bg: #D4B499; /* Muted beige */
            --patra-button-hover: #C7A082;
            --patra-selected-button: #8B4513; /* Saddle brown */
            --patra-chat-bg-user: #EFEFEF; /* Light grey */
            --patra-chat-bg-ai: #FFEBCD; /* Blanched Almond - warm tone */
            --patra-border-color: rgba(139, 69, 19, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #FFDAB9 0%, #CD853F 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        /* --- Splash Screen Styles --- */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('final.png') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .splash-title {
            font-family: 'Lora', serif;
            font-size: clamp(4rem, 10vw, 7rem);
            font-weight: 800;
            color: var(--splash-title-color);
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.1);
            letter-spacing: -2px;
            animation: bounceIn 1s ease-out forwards;
        }

        .splash-subtitle {
            font-family: 'Poppins', sans-serif;
            font-weight: bold;
            font-size: clamp(1.2rem, 3vw, 2rem);
            color: var(--splash-subtitle-color);
            margin-bottom: 50px; /* Adjusted margin to make space for button */
            text-align: center;
            max-width: 80%;
            line-height: 1.5;
            animation: fadeIn 1.5s ease-out 0.5s forwards;
            opacity: 0;
        }

        .loading-circle {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.5);
            border-top: 8px solid var(--primary-brown);
            border-radius: 50%;
            animation: spin 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-bottom: 30px; /* Added margin for button */
        }

        .splash-continue-button {
            background: linear-gradient(45deg, var(--primary-brown), var(--dark-saddle-brown));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .splash-continue-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.3);
            filter: brightness(1.1);
        }

        .splash-motif-top-left {
            position: absolute;
            top: 5%;
            left: 5%;
            font-size: clamp(3rem, 8vw, 6rem);
            color: rgba(255, 255, 255, 0.2);
            transform: rotate(-20deg);
            z-index: -1;
            animation: float 8s ease-in-out infinite alternate;
        }

        .splash-motif-bottom-right {
            position: absolute;
            bottom: 5%;
            right: 5%;
            font-size: clamp(3rem, 8vw, 6rem);
            color: rgba(255, 255, 255, 0.2);
            transform: rotate(15deg);
            z-index: -1;
            animation: float 10s ease-in-out infinite alternate-reverse;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes float {
            0% { transform: translateY(0px) rotate(15deg); }
            50% { transform: translateY(-20px) rotate(18deg); }
            100% { transform: translateY(0px) rotate(15deg); }
        }


        /* --- Landing Page Styles --- */
        .landing-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
            overflow: hidden;
            background: url('final.png') no-repeat center center fixed;
            background-size: cover;
        }

        .landing-container {
            text-align: center;
            max-width: 1000px;
            width: 100%;
            position: relative;
            z-index: 1;
            padding: 20px;
        }

        .namaste-ai-title {
            font-family: 'Lora', serif;
            font-size: clamp(3.5rem, 8vw, 6rem);
            font-weight: 800;
            margin-bottom: 1.5rem;
            color: var(--deep-brown);
            text-shadow: 2px 2px 5px rgba(0,0,0,0.15);
            letter-spacing: -1.5px;
            animation: fadeInScale 1.5s ease-out;
            line-height: 1.1;
        }

        .subtitle {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            margin-bottom: 4rem;
            opacity: 1;
            font-weight: bold;
            line-height: 1.6;
            font-family: 'Poppins', sans-serif;
            color: var(--landing-text-dark);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin: 4rem auto;
            max-width: 1200px;
        }

        .feature-card {
            background: var(--landing-feature-card-bg);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--landing-feature-card-border);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }

        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 18px 40px rgba(0,0,0,0.15);
            background: rgba(255, 255, 255, 0.85);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1.2rem;
            color: var(--primary-brown);
            text-shadow: none;
            transition: transform 0.3s ease;
        }

        .feature-card:hover .feature-icon {
            transform: translateY(-5px);
        }

        .feature-card h3 {
            font-family: 'Lora', serif;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            color: var(--landing-text-dark);
        }

        .feature-card p {
            font-size: 1rem;
            opacity: 0.9;
            color: var(--landing-text-medium);
            line-height: 1.5;
        }

        .cta-button {
            background: linear-gradient(45deg, #FF6347, #FF4500);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 40px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 15px 35px rgba(255, 99, 71, 0.4);
            margin-top: 3rem;
            letter-spacing: 0.5px;
        }

        .cta-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 50px rgba(255, 99, 71, 0.5);
            background: linear-gradient(45deg, #FF4500, #FF6347);
        }

        /* --- Auth Page Styles (Redesigned Backdrop) --- */
        .auth-page {
            display: none;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: url('final.png') no-repeat center center fixed;
            background-size: cover;
        }

        .auth-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 30px;
            padding: 60px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-title {
            font-family: 'Lora', serif;
            color: var(--dark-saddle-brown);
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.8rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .auth-header p {
            font-size: 1.15rem;
            color: #696969;
            font-family: 'Poppins', sans-serif;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 40px;
            border-radius: 20px;
            overflow: hidden;
            background: #F8F8F8;
            padding: 5px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.08);
        }

        .auth-tab {
            flex: 1;
            padding: 18px;
            text-align: center;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 18px;
            border-radius: 15px;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            color: var(--dark-saddle-brown);
        }

        .auth-tab.active {
            background: linear-gradient(45deg, var(--primary-brown), #A0522D);
            color: white;
            box-shadow: 0 8px 25px rgba(160, 82, 45, 0.4);
            transform: translateY(-2px);
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 700;
            color: #4A4A4A;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
        }

        .form-input {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid #E0E0E0;
            border-radius: 15px;
            font-size: 17px;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            outline: none;
            background: #FAFAFA;
            font-family: 'Poppins', sans-serif;
            color: #333;
        }

        .form-input:focus {
            border-color: var(--primary-brown);
            box-shadow: 0 0 0 5px rgba(205, 133, 63, 0.2);
            background: white;
        }

        .auth-button {
            width: 100%;
            background: linear-gradient(45deg, var(--primary-brown), #A0522D);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 15px 40px rgba(160, 82, 45, 0.3);
        }

        .auth-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 50px rgba(160, 82, 45, 0.4);
        }

        /* --- Main App Styles --- */
        .main-app {
            display: none;
            min-height: 100vh;
            background: var(--light-cream);
        }

        .app-header {
            background: linear-gradient(to right, var(--primary-brown), #A0522D);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
            padding: 0 40px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 90px;
        }

        .app-logo {
            font-family: 'Lora', serif;
            font-size: 2.2rem;
            font-weight: 800;
            color: #FFFFFF;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
            letter-spacing: -0.5px;
        }

        .nav-ribbon {
            display: flex;
            gap: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px;
            box-shadow: inset 0 2px 12px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .nav-tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            color: #FFF;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
            font-family: 'Poppins', sans-serif;
        }

        .nav-tab.active {
            background: var(--dark-saddle-brown);
            color: white;
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
            transform: translateY(-2px);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: #FFF;
            transform: translateY(-1px);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .welcome-text {
            font-weight: 600;
            color: #FFF;
            font-size: 17px;
            font-family: 'Poppins', sans-serif;
            padding-left: 15px; /* Added padding-left here */
        }

        .logout-btn {
            background: var(--crimson-red);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);
        }

        .logout-btn:hover {
            background: var(--firebrick-red);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(178, 34, 34, 0.3);
        }

        .app-content {
            background: url('final.png') no-repeat center center fixed;
            background-size: cover;

            max-width: 1400px;
            margin: 0 auto;
            padding: 50px 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* --- Feature Section Styles (General for all content cards) --- */
        .content-card {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border: 1px solid #EAEAEA;
        }

        .section-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-title h2 {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            color: var(--dark-saddle-brown);
            margin-bottom: 12px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        .section-title p {
            color: #696969;
            font-size: 1.2rem;
            font-family: 'Poppins', sans-serif;
        }

        /* --- Itihaas Reimagined Specific Styles --- */
        .itihaas-reimagined-container {
            background: var(--parchment-background);
            border-radius: 25px;
            padding: 40px;
            max-width: 900px;
            margin: 0 auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--parchment-border);
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .itihaas-title-card {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.7);
        }

        .itihaas-title-card h2 {
            font-family: 'Merriweather', serif;
            font-size: 3rem;
            color: var(--deep-brown);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .itihaas-title-card .icon-seal {
            font-size: 4rem;
            color: var(--muted-maroon);
            margin-bottom: 20px;
            display: block;
        }
        
        .itihaas-description {
            font-family: 'DM Sans', sans-serif;
            font-size: 1.1rem;
            color: var(--text-on-parchment);
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .what-if-selector {
            width: 100%;
            max-width: 500px;
            margin: 0 auto 30px;
            padding: 15px 20px;
            font-family: 'DM Sans', sans-serif;
            font-size: 1.1rem;
            border: 2px solid var(--parchment-border);
            border-radius: 12px;
            background-color: white;
            color: var(--warm-black);
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="%234B3621" d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 11.172 6.757 7.929 5.343 9.343z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .what-if-selector:focus {
            outline: none;
            border-color: var(--muted-maroon);
            box-shadow: 0 0 0 4px rgba(128, 0, 0, 0.1);
        }

        .generate-btn {
            background: linear-gradient(45deg, var(--muted-maroon), var(--deep-brown));
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 40px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(128, 0, 0, 0.3);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin-bottom: 40px;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(128, 0, 0, 0.4);
            filter: brightness(1.1);
        }

        .narrative-result {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            padding: 30px;
            text-align: left;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.8);
            color: var(--text-on-parchment);
            font-family: 'DM Sans', sans-serif;
            font-size: 1.05rem;
            line-height: 1.8;
            max-height: 500px;
            overflow-y: auto;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .narrative-result.active {
            opacity: 1;
            transform: translateY(0);
        }

        .narrative-result h3 {
            font-family: 'Merriweather', serif;
            color: var(--deep-brown);
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 700;
            text-align: center;
        }

        .itihaas-loading {
            display: none;
            margin: 30px auto;
            text-align: center;
            color: var(--text-on-parchment);
            font-family: 'DM Sans', sans-serif;
            font-size: 1rem;
        }

        .itihaas-spinner {
            border: 4px solid rgba(75, 54, 33, 0.2);
            border-top: 4px solid var(--deep-brown);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }


        /* --- Sanskriti Sync Specific Styles (Integrated) --- */
        .sanskriti-sync-wrapper {
            background-color: var(--sanskriti-card-background);
            border-radius: 25px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(205, 133, 63, 0.1);
            margin: 0 auto;
        }
        
        .sanskriti-sync-wrapper::before {
            content: '';
            position: absolute;
            top: -50px;
            left: -50px;
            right: -50px;
            bottom: -50px;
            background-image: url('data:image/svg+xml,%3Csvg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M49.92 0C22.37 0 0 22.37 0 49.92s22.37 49.92 49.92 49.92 49.92-22.37 49.92-49.92S77.47 0 49.92 0zm0 91.56c-22.95 0-41.64-18.69-41.64-41.64S26.97 8.28 49.92 8.28s41.64 18.69 41.64 41.64-18.69 41.64-41.64 41.64zM50 20c-16.57 0-30 13.43-30 30s13.43 30 30 30 30-13.43 30-30-13.43-30-30-30zm0 51.56c-11.82 0-21.36-9.54-21.36-21.36S38.18 28.64 50 28.64s21.36 9.54 21.36 21.36-9.54 21.36-21.36 21.36z" fill="%23e0c7a4" fill-opacity="0.1"/%3E%3C/svg%3E');
            opacity: 0.7;
            z-index: 0;
            pointer-events: none;
        }

        .sanskriti-app-title {
            font-family: 'Lora', serif;
            font-size: 3.8rem;
            font-weight: 700;
            color: var(--sanskriti-dark-brown);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.05);
            position: relative;
            z-index: 1;
            background: linear-gradient(45deg, var(--sanskriti-medium-brown), var(--sanskriti-dark-brown));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .sanskriti-app-subtitle {
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            color: var(--sanskriti-light-text-color);
            margin-bottom: 30px;
            font-weight: 400;
            position: relative;
            z-index: 1;
        }

        .sanskriti-question-card {
            background-color: var(--sanskriti-soft-gold);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--sanskriti-medium-brown);
            position: relative;
            z-index: 1;
            display: none;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .sanskriti-question-card.active {
            display: block;
        }

        .sanskriti-question-category {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            color: var(--sanskriti-medium-brown);
            margin-bottom: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sanskriti-question-text {
            font-family: 'Lora', serif;
            font-size: 1.8rem;
            color: var(--sanskriti-dark-brown);
            margin-bottom: 25px;
            font-weight: 600;
        }

        .sanskriti-option-button {
            display: block;
            width: 100%;
            padding: 18px 25px;
            margin-bottom: 15px;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: linear-gradient(90deg, var(--sanskriti-button-gradient-start), var(--sanskriti-button-gradient-end));
            color: white;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .sanskriti-option-button:hover:not(.selected) {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            filter: brightness(1.1);
        }

        .sanskriti-option-button.selected {
            background: linear-gradient(90deg, var(--sanskriti-selected-gradient-start), var(--sanskriti-selected-gradient-end));
            border: 3px solid var(--sanskriti-dark-brown);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6), 0 8px 25px rgba(0, 0, 0, 0.2);
            transform: scale(1.01);
            color: var(--sanskriti-dark-brown);
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .sanskriti-quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 15px;
            position: relative;
            z-index: 1;
        }

        .sanskriti-nav-button {
            padding: 12px 25px;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            background-color: var(--sanskriti-nav-button-bg);
            color: var(--sanskriti-dark-brown);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            flex-grow: 1;
            max-width: 150px;
        }

        .sanskriti-nav-button:hover {
            background-color: var(--sanskriti-nav-button-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .sanskriti-nav-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .sanskriti-cta-button {
            display: block;
            width: 80%;
            max-width: 300px;
            margin: 30px auto 0;
            padding: 18px 30px;
            border: none;
            border-radius: 40px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            background: linear-gradient(45deg, var(--sanskriti-dark-brown), var(--sanskriti-medium-brown));
            color: white;
            box-shadow: 0 10px 30px rgba(139, 69, 19, 0.4);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            z-index: 1;
        }

        .sanskriti-cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 18px 45px rgba(139, 69, 19, 0.6);
            filter: brightness(1.1);
        }

        .sanskriti-result-screen {
            display: none;
            padding-top: 20px;
        }

        .sanskriti-result-title {
            font-family: 'Lora', serif;
            font-size: 2.5rem;
            color: var(--sanskriti-dark-brown);
            margin-bottom: 25px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        .sanskriti-cultural-traditions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 25px;
            justify-content: center;
        }

        .sanskriti-tradition-card {
            background-color: var(--sanskriti-card-background);
            border-radius: 18px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(205, 133, 63, 0.15);
            transition: transform 0.3s ease;
            text-align: center;
        }

        .sanskriti-tradition-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .sanskriti-tradition-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--sanskriti-medium-brown);
            display: inline-block;
            background-color: var(--sanskriti-soft-gold);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .sanskriti-tradition-card h3 {
            font-family: 'Lora', serif;
            font-size: 1.3rem;
            color: var(--sanskriti-dark-brown);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .sanskriti-tradition-card p {
            font-size: 0.95rem;
            color: var(--sanskriti-light-text-color);
            line-height: 1.4;
        }

        .sanskriti-no-results-message {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            color: var(--sanskriti-light-text-color);
            margin-top: 30px;
        }

        /* --- Past Patra Styles --- */
        .past-patra-container {
            background: linear-gradient(135deg, var(--patra-bg-light), var(--patra-bg-dark)); /* Earthy gradient */
            border-radius: 25px;
            padding: 30px; /* Original padding */
            max-width: 1200px; /* Increased max-width for two columns */
            margin: 0 auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--patra-border-color);
            display: flex;
            flex-direction: column;
            min-height: 80vh; /* Changed from fixed height */
            height: auto; /* Allow auto height based on content */
            max-height: 95vh; /* Prevent overflowing viewport on very large screens */
            position: relative;
        }

        .patra-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .patra-title {
            font-family: 'Merriweather', serif;
            font-size: 2.5rem;
            color: var(--patra-heading-color);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .patra-description {
            font-family: 'DM Sans', sans-serif;
            font-size: 1rem;
            color: var(--patra-text-color);
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .patra-content-wrapper {
            display: flex;
            flex-grow: 1;
            gap: 20px; /* Space between left and right columns */
        }

        .personality-selector-column {
            flex: 0 0 280px; /* Fixed width for personality selector */
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding-right: 10px; /* Add some padding to the right */
            overflow-y: auto; /* Make personality list scrollable */
            max-height: calc(100vh - 250px); /* Adjust based on header/footer height */
        }

        .personality-button {
            background: var(--patra-button-bg);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 15px;
            padding: 12px 20px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--patra-heading-color);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%; /* Ensure buttons take full width of their column */
            text-align: left;
        }

        .personality-button:hover:not(.selected) {
            background: var(--patra-button-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }

        .personality-button.selected {
            background: var(--patra-selected-button);
            color: white;
            border-color: var(--sanskriti-dark-brown);
            box-shadow: 0 6px 18px rgba(139, 69, 19, 0.3);
            transform: scale(1.02);
        }

        .personality-button i {
            font-size: 1.1rem;
        }

        .chat-area-column {
            flex-grow: 1; /* Takes remaining space */
            display: flex;
            flex-direction: column;
            background: var(--patra-bg-light);
            border-radius: 15px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.03);
            border: 1px solid var(--patra-border-color);
        }

        .chat-panel {
            flex-grow: 1; /* Takes remaining space */
            padding: 20px;
            overflow-y: auto; /* Scrollable chat area */
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 250px; /* Ensure a decent minimum height for chat */
        }

        .chat-bubble {
            max-width: 75%;
            padding: 12px 18px;
            border-radius: 18px;
            line-height: 1.5;
            word-wrap: break-word; /* Ensure long words break */
            font-family: 'DM Sans', sans-serif;
            font-size: 0.95rem;
        }

        .user-message {
            background-color: var(--patra-chat-bg-user);
            color: var(--patra-text-color);
            align-self: flex-end; /* Align to right */
            border-bottom-right-radius: 5px; /* Slightly less rounded corner */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .ai-message {
            background-color: var(--patra-chat-bg-ai);
            color: var(--patra-heading-color); /* Darker text for AI */
            align-self: flex-start; /* Align to left */
            border-bottom-left-radius: 5px; /* Slightly less rounded corner */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            padding: 15px 20px; /* Padding for input area */
            background-color: var(--patra-bg-light);
            border-top: 1px solid var(--patra-border-color); /* Visual separator */
            border-radius: 0 0 15px 15px; /* Match chat-area-column bottom radius */
            box-shadow: 0 -5px 15px rgba(0,0,0,0.05); /* Subtle shadow upwards */
        }

        .message-input {
            flex-grow: 1;
            padding: 12px 18px;
            border: 1px solid var(--patra-border-color);
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
            resize: none; /* Prevent manual resizing */
            min-height: 45px; /* Ensure it's not too small */
            max-height: 120px; /* Limit expansion */
            overflow-y: auto; /* Scroll if text exceeds max-height */
        }

        .message-input:focus {
            border-color: var(--primary-brown);
            box-shadow: 0 0 0 3px rgba(205, 133, 63, 0.1);
        }

        .send-button {
            background: var(--primary-brown);
            color: white;
            border: none;
            border-radius: 50%; /* Circular button */
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .send-button:hover {
            background: var(--dark-saddle-brown);
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .patra-loading-spinner {
            display: none;
            text-align: center;
            margin-top: 15px;
            color: var(--patra-text-color);
        }

        .patra-loading-spinner .spinner {
            border: 4px solid var(--patra-button-bg);
            border-top: 4px solid var(--patra-selected-button);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 5px;
        }

        /* --- Mantrarth Specific Styling (Redesigned) --- */
        .mantrarth-container {
            background: linear-gradient(135deg, var(--patra-bg-light), var(--patra-bg-dark)); /* Consistent with Past Patra bg */
            border-radius: 25px;
            padding: 30px;
            max-width: 900px; /* Adjusted for content */
            margin: 0 auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--patra-border-color);
            text-align: center;
        }

        .mantrarth-header {
            margin-bottom: 30px;
        }

        .mantrarth-title {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            color: var(--patra-heading-color); /* Darker brown for titles */
            margin-bottom: 12px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        .mantrarth-description {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            color: var(--patra-text-color);
            line-height: 1.6;
            max-width: 700px;
            margin: 0 auto;
        }

        .mantra-list-screen {
            /* This wrapper helps manage the list and detail screen states */
        }

        .mantra-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            background-color: var(--sanskriti-soft-gold); /* A soft background for the list */
            border-radius: 15px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            max-height: 600px; /* Make list scrollable if many mantras */
            overflow-y: auto;
            border: 1px solid var(--sanskriti-medium-brown);
        }

        .mantra-card {
            background-color: var(--sanskriti-card-background);
            border: 1px solid var(--patra-border-color);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .mantra-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }

        .mantra-card h3 {
            font-family: 'Lora', serif;
            color: var(--patra-heading-color);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.4em;
            font-weight: 600;
        }

        .mantra-card .original-script {
            font-family: 'Noto Sans Devanagari', sans-serif;
            font-size: 1.1em;
            color: var(--dark-saddle-brown); /* Stronger brown highlight */
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
        }

        .mantra-card .short-meaning {
            font-family: 'DM Sans', sans-serif;
            font-size: 0.95em;
            color: var(--patra-text-color);
            line-height: 1.4;
        }

        /* Mantra Detail Screen */
        .mantra-detail-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: var(--parchment-background); /* Soft, parchment-like background */
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            min-height: 400px;
            border: 1px solid var(--parchment-border);
        }

        .back-button-container {
            width: 100%;
            text-align: left;
            margin-bottom: 20px;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--dark-saddle-brown);
            font-size: 1.1em;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease;
            padding: 8px 12px;
            border-radius: 10px;
        }

        .back-btn:hover {
            color: var(--primary-brown);
            transform: translateX(-5px);
            background-color: rgba(205, 133, 63, 0.1);
        }

        .mantra-detail-content {
            flex-grow: 1;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            color: var(--patra-text-color);
            font-family: 'DM Sans', sans-serif;
        }

        .mantra-detail-content h2 {
            font-family: 'Lora', serif;
            color: var(--deep-brown); /* Consistent with Itihaas titles */
            font-size: 2.5em;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--sanskriti-medium-brown);
            padding-bottom: 10px;
            font-weight: 700;
        }

        .mantra-text-block {
            background-color: var(--sanskriti-soft-gold); /* Lighter, warmer tone */
            border: 1px solid var(--sanskriti-medium-brown);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
        }

        .mantra-text-block .original-script {
            font-family: 'Noto Sans Devanagari', sans-serif;
            font-size: 1.8em;
            color: var(--dark-saddle-brown); /* Primary accent color */
            line-height: 1.6;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .mantra-text-block .transliteration {
            font-family: 'Poppins', sans-serif;
            font-style: italic;
            font-size: 1.1em;
            color: var(--primary-brown); /* Brown for transliteration */
            margin-bottom: 15px;
        }

        .mantra-text-block .poetic-meaning {
            font-family: 'DM Sans', sans-serif;
            font-size: 1em;
            color: var(--patra-text-color);
            line-height: 1.7;
        }

        .mantra-full-meaning,
        .mantra-cultural-context {
            text-align: left;
            margin-bottom: 20px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.7); /* Slightly transparent white for content blocks */
            border-radius: 15px;
            border: 1px solid rgba(205, 133, 63, 0.2);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            line-height: 1.7;
        }

        .mantra-full-meaning h3,
        .mantra-cultural-context h3 {
            font-family: 'Lora', serif;
            color: var(--dark-saddle-brown);
            font-size: 1.6rem;
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }

        .mantra-audio-controls {
            margin-top: 20px;
            position: relative;
            display: flex; /* Changed to flex for buttons */
            justify-content: center; /* Center buttons */
            gap: 15px; /* Space between buttons */
            padding: 10px; /* Padding to ensure glow is visible */
        }

        .play-pause-btn, .stop-mantra-btn {
            background: linear-gradient(45deg, var(--sanskriti-gold), var(--sanskriti-selected-gradient-end)); /* Gold gradient for button */
            color: var(--patra-heading-color); /* Dark text on gold */
            padding: 15px 35px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1; /* Keep button above glow */
        }

        .stop-mantra-btn {
            background: linear-gradient(45deg, #DC143C, #B22222); /* Red gradient for stop button */
            color: white;
            box-shadow: 0 8px 20px rgba(220, 20, 60, 0.3);
        }

        .play-pause-btn:hover {
            background: linear-gradient(45deg, var(--sanskriti-selected-gradient-end), var(--sanskriti-gold));
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 215, 0, 0.4);
            filter: brightness(1.05);
        }

        .stop-mantra-btn:hover {
            background: linear-gradient(45deg, #B22222, #DC143C);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(178, 34, 34, 0.4);
            filter: brightness(1.05);
        }

        .play-pause-btn i, .stop-mantra-btn i {
            font-size: 1.2em;
        }

        .mantra-visual-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--sanskriti-gold) 0%, rgba(255, 215, 0, 0) 70%); /* Glowing effect */
            border-radius: 50%;
            opacity: 0.3;
            pointer-events: none; /* Allow clicks through */
            z-index: 0;
            animation: pulseGlow 3s infinite alternate;
        }

        @keyframes pulseGlow {
            0% { transform: translate(-50%, -50%) scale(0.9); opacity: 0.2; }
            100% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.4; }
        }

        .mantra-loading-spinner {
            display: none;
            margin: 30px auto;
            text-align: center;
            color: var(--patra-text-color);
            font-family: 'DM Sans', sans-serif;
            font-size: 1rem;
        }

        .mantra-loading-spinner .spinner {
            border: 4px solid var(--patra-button-bg);
            border-top: 4px solid var(--patra-selected-button);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 5px;
        }


        /* --- Monument Safari Styles (Merged from monument.txt) --- */
        .monument-safari-container {
            background: linear-gradient(135deg, #c19a6b 0%, #f0ca92 58%, #5f4226 100%);
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden; /* Ensure map elements don't overflow */
        }

        .game-title {
            position: relative; /* Changed to relative for flow within container */
            margin-bottom: 20px; /* Add margin to separate from content */
            background: linear-gradient(to right, #d2b48c, #f4e4bc);
            color: #52300a;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 2rem;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1; /* Ensure it's above map */
        }

        .badge-display {
            position: absolute; /* Changed to absolute relative to container */
            top: 20px;
            right: 20px;
            font-size: 22px;
            font-weight: bold;
            background: #fff8dc;
            padding: 10px 16px;
            border-radius: 10px;
            box-shadow: 0 0 8px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .game-container {
            position: relative;
            width: 100%;
            flex-grow: 1; /* Allow it to take available space */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .india-map {
            position: relative;
            width: 100%;
            max-width: 800px; /* Limit map width */
            height: 500px; /* Fixed height for map area */
            background: linear-gradient(135deg, #c28a40 0%, #e6ae65 58%, #f5a741 100%);
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .map-outline {
            position: absolute;
            top: 0; /* Adjusted to fill parent */
            left: 0; /* Adjusted to fill parent */
            width: 100%;
            height: 100%;
            background: #f9f5e7;
            border: 4px solid #b04513;
            border-radius: 15px; /* Match parent */
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .india-shape {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.8;
            z-index: 1;
            fill: #D2B48C;
        }

        .monument-marker {
            position: absolute;
            width: 40px; /* Smaller markers */
            height: 40px;
            background: #fff8dc;
            border-radius: 50%;
            border: 3px solid #b04513;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem; /* Smaller icon */
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 5;
            transform: translate(-50%, -50%); /* Center marker on its position */
        }

        .monument-marker:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0px 12px rgba(0,0,0,0.3);
        }

        .monument-marker.current {
            border-color: #c08b29;
            background: radial-gradient(circle, #bb893e, #925c0c);
            color: white;
            animation: pulse 2s infinite;
        }

        .monument-marker.visited {
            background: linear-gradient(135deg, #ffd700, #ffe4de);
            border-color: #20b2aa;
        }

        .monument-marker.unvisited {
            background: linear-gradient(135deg, #fff, #f0f0f0);
            color: #666;
        }

        @keyframes pulse {
            0% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 rgba(255,107,107,0.7); }
            70% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 20px rgba(255,107,107,0); }
            100% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 rgba(255,107,107,0); }
        }

        .monument-label {
            position: absolute;
            top: -25px; /* Adjusted for smaller marker */
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.85);
            color: white;
            padding: 2px 6px; /* Smaller padding */
            border-radius: 4px;
            font-size: 0.8rem; /* Smaller font */
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .monument-marker:hover .monument-label {
            opacity: 1;
        }

        .game-controls {
            position: relative; /* Changed to relative for flow within container */
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            margin-top: 20px;
        }

        .dice-container {
            background: rgba(255,255,255,0.9);
            padding: 15px; /* Smaller padding */
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            text-align: center;
        }

        .dice {
            width: 50px; /* Smaller dice */
            height: 50px;
            background: linear-gradient(135deg, #fff, #f0f0f0);
            border: 3px solid #b04513;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem; /* Smaller font */
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .dice:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .dice.rolling {
            animation: diceRoll 1s ease-in-out;
        }

        @keyframes diceRoll {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(90deg) scale(1.1); }
            50% { transform: rotate(180deg) scale(1.2); }
            75% { transform: rotate(270deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .roll-btn {
            background: linear-gradient(135deg, #20b2aa, #008080);
            color: white;
            border: none;
            padding: 10px 20px; /* Smaller padding */
            border-radius: 20px;
            font-size: 0.8rem; /* Smaller font */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .roll-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .roll-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .game-stats {
            position: absolute; /* Absolute relative to monument-safari-container */
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-size: 0.9rem;
            z-index: 10;
        }

        #know-about-btn {
            font-size: 1rem; /* Smaller font */
            padding: 12px 25px; /* Smaller padding */
            margin-top: 20px;
            background-color: #cd853f;
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: background-color 0.3s;
        }

        #know-about-btn:hover {
            background-color: #b37431;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000; /* Ensure it's on top */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background: rgba(0,0,0,0.8);
            overflow-y: auto;
        }

        .modal-content {
            background: linear-gradient(135deg, #fff, #f8f8f8);
            margin: 30px auto;
            padding: 30px;
            border-radius: 20px;
            max-width: 1000px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 25px;
            font-size: 2rem;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #000;
        }

        .monument-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #20b2aa, #008080);
            border-radius: 15px;
            color: white;
        }

        .monument-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .monument-icon-large {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .monument-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .info-section {
            background: #f8f8f8;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #ffd700;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-grid {
            display: grid;
            gap: 15px;
        }

        .info-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #20b2aa;
        }

        .info-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 5px;
        }

        .info-value {
            color: #333;
            font-size: 1.1rem;
        }

        .facts-section {
            grid-column: span 2;
            background: #f8f8f8;
            padding: 25px;
            border-radius: 15px;
            border-left: 2px solid #20b2aa;
        }

        .fact-item {
            background: white;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #ffd700;
        }

        .quiz-section {
            grid-column: span 2;
            background: linear-gradient(135deg, #fff5f5, #ffe0e0);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #ff6b6b;
        }

        .quiz-question {
            margin-bottom: 25px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .quiz-option {
            background: #f8f8f8;
            border: 2px solid #ddd;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }

        .quiz-option:hover {
            border-color: #20b2aa;
            background: #f0f8ff;
        }

        .quiz-option.correct {
            background: #d4edd4;
            border-color: #28a745;
            color: #155724;
        }

        .quiz-option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        /* Monument positions on map (relative to map-outline) */
        .delhi { top: 28%; left: 48%; }
        .punjab { top: 15%; left: 35%; }
        .rajasthan { top: 30%; left: 25%; }
        .uttar-pradesh { top: 25%; left: 45%; }
        .madhya-pradesh { top: 40%; left: 40%; }
        .gujarat { top: 40%; left: 20%; }
        .maharashtra { top: 55%; left: 25%; }
        .karnataka { top: 70%; left: 35%; }
        .tamil-nadu { top: 80%; left: 40%; }
        .kerala { top: 85%; left: 40%; }
        .telangana { top: 65%; left: 50%; }
        .west-bengal { top: 45%; left: 70%; }
        .odisha { top: 50%; left: 65%; }
        .bihar { top: 35%; left: 55%; }
        .jharkhand { top: 43%; left: 60%; }

        /* Path styling */
        .monument-path {
            position: absolute;
            stroke: #8b4513;
            stroke-width: 5;
            stroke-dasharray: 10;
            fill: none;
            z-index: 1;
            animation: dash 30s linear infinite;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: 1000;
            }
        }

        /* Player token */
       .player-token {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle at 30% 30%, red, darkred);
            border: 2px solid #fff;
            border-radius: 50% 50% 40% 40% / 50% 50% 20% 20%;
            transition: all 0.5s;
            box-shadow: 0 0 8px rgba(0,0,0,0.4);
            z-index: 6; /* Ensure token is above markers */
            transform: translate(-50%, -50%); /* Center token on its position */
        }

        /* --- Media Queries for Responsiveness (Merged and Updated) --- */
        @media (max-width: 1024px) {
            .splash-title { font-size: clamp(3rem, 8vw, 5rem); }
            .splash-subtitle { font-size: clamp(1rem, 2.5vw, 1.6rem); }
            .loading-circle { width: 60px; height: 60px; border-width: 6px; }
            .splash-motif-top-left, .splash-motif-bottom-right { font-size: clamp(2rem, 6vw, 4rem); }
            .splash-continue-button { padding: 12px 25px; font-size: 1rem; }


            .namaste-ai-title { font-size: clamp(3rem, 7vw, 4.5rem); }
            .subtitle { font-size: clamp(1rem, 2.5vw, 1.4rem); }
            .header-content { flex-direction: column; height: auto; padding: 20px 0; gap: 15px; }
            .nav-ribbon { overflow-x: auto; width: 100%; justify-content: flex-start; }
            .nav-tab { white-space: nowrap; padding: 12px 20px; font-size: 14px; }
            .user-section { gap: 15px; }
            .welcome-text { font-size: 15px; }
            .logout-btn { padding: 8px 15px; font-size: 13px; }

            .itihaas-reimagined-container { padding: 30px; }
            .itihaas-title-card h2 { font-size: 2.5rem; }
            .itihaas-title-card .icon-seal { font-size: 3.5rem; }
            .itihaas-description { font-size: 1rem; }
            .what-if-selector { font-size: 1rem; padding: 12px 15px; }
            .generate-btn { font-size: 1.1rem; padding: 12px 30px; }
            .narrative-result { padding: 25px; font-size: 1rem; }

            .sanskriti-sync-wrapper { padding: 30px; }
            .sanskriti-app-title { font-size: 3rem; }
            .sanskriti-app-subtitle { font-size: 1rem; margin-bottom: 25px; }
            .sanskriti-question-card { padding: 25px; }
            .sanskriti-question-category { font-size: 1rem; }
            .sanskriti-question-text { font-size: 1.5rem; }
            .sanskriti-option-button { padding: 15px 20px; font-size: 1rem; }
            .sanskriti-nav-button { padding: 10px 20px; font-size: 0.9rem; }
            .sanskriti-cta-button { width: 90%; padding: 15px 25px; font-size: 1.1rem; }
            .sanskriti-result-title { font-size: 2.0rem; }
            .sanskriti-cultural-traditions-grid { grid-template-columns: 1fr; }
            .sanskriti-tradition-icon { width: 45px; height: 45px; line-height: 45px; font-size: 1.8rem; }
            .sanskriti-tradition-card h3 { font-size: 1.2rem; }
            .sanskriti-tradition-card p { font-size: 0.9rem; }

            .past-patra-container { 
                padding: 25px; /* Adjusted for more height */
                min-height: 85vh; 
                max-height: 95vh;
            }
            .patra-title { font-size: 2rem; }
            .patra-description { font-size: 0.95rem; }
            .personality-selector-column { flex: 0 0 200px; } /* Adjusted for smaller screens */
            .personality-button { padding: 10px 15px; font-size: 0.9rem; }
            .chat-bubble { font-size: 0.9rem; padding: 10px 15px; }
            .message-input { font-size: 0.95rem; padding: 10px 15px; }
            .send-button { width: 40px; height: 40px; font-size: 1.1rem; }

            .chat-input-area { /* Responsive adjustment for chat-input-area */
                padding: 15px 20px; /* Match new container padding */
            }

            /* Responsive Adjustments for Mantrarth */
            .mantrarth-container { padding: 25px; max-width: 800px; }
            .mantrarth-title { font-size: 2.5rem; }
            .mantrarth-description { font-size: 1rem; }
            .mantra-list { padding: 15px; max-height: 500px; }
            .mantra-card { padding: 18px; }
            .mantra-card h3 { font-size: 1.3em; }
            .mantra-card .original-script { font-size: 1em; }
            .mantra-detail-screen { padding: 25px; }
            .mantra-detail-content h2 { font-size: 2.2em; }
            .mantra-text-block { padding: 20px; }
            .mantra-text-block .original-script { font-size: 1.6em; }
            .mantra-text-block .transliteration { font-size: 1em; }
            .play-pause-btn, .stop-mantra-btn { padding: 12px 30px; font-size: 1em; }

            /* Monument Safari */
            .monument-safari-container { padding: 15px; }
            .game-title { font-size: 1.5rem; padding: 10px 20px; }
            .game-stats { font-size: 0.8rem; padding: 10px; top: 10px; left: 10px; }
            .badge-display { font-size: 18px; top: 10px; right: 10px; padding: 8px 12px; }
            .india-map { height: 400px; }
            .monument-marker { width: 35px; height: 35px; font-size: 1rem; }
            .monument-label { font-size: 0.7rem; top: -20px; }
            .dice { width: 45px; height: 45px; font-size: 1rem; }
            .roll-btn { padding: 8px 15px; font-size: 0.7rem; }
            #know-about-btn { font-size: 0.9rem; padding: 10px 20px; }
            .modal-content { margin: 20px auto; padding: 20px; }
            .monument-title { font-size: 2rem; }
            .monument-icon-large { font-size: 3rem; }
            .monument-details { grid-template-columns: 1fr; gap: 20px; }
            .info-section, .facts-section, .quiz-section { padding: 20px; }
            .section-title { font-size: 1.2rem; }
            .info-item { padding: 12px; }
            .info-value { font-size: 1rem; }
            .fact-item { padding: 12px; }
            .quiz-question { padding: 15px; }
            .question-text { font-size: 1rem; }
            .quiz-options { grid-template-columns: 1fr; }
            .quiz-option { padding: 10px; font-size: 0.9rem; }
        }

        @media (max-width: 480px) {
            .splash-title { font-size: clamp(1.8rem, 10vw, 3rem); }
            .splash-subtitle { font-size: clamp(0.8rem, 3vw, 1.1rem); margin-bottom: 25px; }
            .loading-circle { width: 40px; height: 40px; border-width: 4px; margin-bottom: 15px; }
            .splash-continue-button { padding: 8px 15px; font-size: 0.85rem; }


            .namaste-ai-title { font-size: clamp(2rem, 10vw, 3rem); }
            .subtitle { font-size: clamp(0.9rem, 3vw, 1.1rem); }
            .features-grid { grid-template-columns: 1fr; gap: 1.5rem; }
            .auth-container { padding: 25px; }
            .auth-title { font-size: 2rem; }
            .auth-header p { font-size: 0.9rem; }
            .nav-ribbon { padding: 5px; }
            .nav-tab { padding: 8px 12px; font-size: 12px; gap: 5px; }
            .app-logo { font-size: 1.5rem; }
            .user-section { flex-direction: column; align-items: flex-end; gap: 10px; }
            .welcome-text { font-size: 14px; }

            .itihaas-reimagined-container { padding: 20px; border-radius: 15px; }
            .itihaas-title-card h2 { font-size: 1.8rem; }
            .itihaas-title-card .icon-seal { font-size: 2.5rem; }
            .itihaas-description { font-size: 0.9rem; }
            .generate-btn { font-size: 1rem; padding: 10px 25px; }
            .narrative-result { padding: 20px; font-size: 0.95rem; max-height: 300px; }

            .sanskriti-sync-wrapper { padding: 20px; border-radius: 15px; }
            .sanskriti-app-title { font-size: 2.2rem; }
            .sanskriti-app-subtitle { font-size: 0.9rem; }
            .sanskriti-question-card { padding: 20px; border-radius: 15px; }
            .sanskriti-question-category { font-size: 0.9rem; }
            .sanskriti-question-text { font-size: 1.2rem; margin-bottom: 20px; }
            .sanskriti-option-button { padding: 12px 15px; font-size: 0.9rem; border-radius: 10px; }
            .sanskriti-nav-button { padding: 8px 15px; font-size: 0.8rem; border-radius: 20px; }
            .sanskriti-cta-button { padding: 12px 20px; font-size: 1rem; border-radius: 30px; }
            .sanskriti-result-title { font-size: 1.8rem; }
            .sanskriti-tradition-icon { width: 35px; height: 35px; line-height: 35px; font-size: 1.2rem; }

            .past-patra-container { 
                padding: 15px; 
                min-height: 85vh; /* Adjusted for more height */
                max-height: 95vh;
            }
            .patra-title { font-size: 1.5rem; }
            .patra-description { font-size: 0.8rem; }
            .patra-content-wrapper { flex-direction: column; } /* Stack columns on very small screens */
            .personality-selector-column { flex: none; width: 100%; max-height: 200px; } /* Adjust height for stacked layout */
            .personality-button { padding: 6px 10px; font-size: 0.8rem; }
            .chat-bubble { font-size: 0.8rem; padding: 8px 12px; }
            .message-input { font-size: 0.85rem; padding: 8px 12px; min-height: 40px; }
            .send-button { width: 30px; height: 30px; font-size: 0.9rem; }
            
            .chat-input-area { /* Responsive adjustment for chat-input-area */
                padding: 15px; /* Match new container padding */
            }

            /* Responsive Adjustments for Mantrarth */
            .mantrarth-container { padding: 15px; }
            .mantrarth-title { font-size: 1.8rem; }
            .mantrarth-description { font-size: 0.85rem; }
            .mantra-list { 
                grid-template-columns: 1fr; /* Stack vertically on very small screens */
                gap: 15px; 
                padding: 10px;
            }
            .mantra-card { padding: 12px; }
            .mantra-card h3 { font-size: 1.1em; }
            .mantra-card .original-script { font-size: 0.8em; }
            .mantra-card .short-meaning { font-size: 0.85em; }
            .mantra-detail-screen { padding: 15px; }
            .mantra-detail-content h2 { font-size: 1.7em; }
            .mantra-text-block { padding: 12px; }
            .mantra-text-block .original-script { font-size: 1.2em; }
            .mantra-text-block .transliteration { font-size: 0.9em; }
            .mantra-full-meaning, .mantra-cultural-context { font-size: 0.9em; padding: 12px; }
            .play-pause-btn, .stop-mantra-btn { padding: 8px 20px; font-size: 0.8em; }
            .play-pause-btn i, .stop-mantra-btn i { font-size: 1em; }
            .mantra-visual-effect { width: 100px; height: 100px; }

            /* Monument Safari */
            .monument-safari-container { padding: 10px; }
            .game-title { font-size: 1.2rem; padding: 8px 15px; }
            .game-stats { font-size: 0.7rem; padding: 8px; top: 5px; left: 5px; }
            .badge-display { font-size: 16px; top: 5px; right: 5px; padding: 6px 10px; }
            .india-map { height: 300px; }
            .monument-marker { width: 30px; height: 30px; font-size: 0.9rem; }
            .monument-label { font-size: 0.6rem; top: -18px; }
            .dice { width: 40px; height: 40px; font-size: 0.9rem; }
            .roll-btn { padding: 6px 12px; font-size: 0.6rem; }
            #know-about-btn { font-size: 0.8rem; padding: 8px 15px; }
            .modal-content { margin: 15px auto; padding: 15px; }
            .monument-title { font-size: 1.8rem; }
            .monument-icon-large { font-size: 2.5rem; }
            .monument-details { gap: 15px; }
            .info-section, .facts-section, .quiz-section { padding: 15px; }
            .section-title { font-size: 1.1rem; }
            .info-item { padding: 10px; }
            .info-value { font-size: 0.9rem; }
            .fact-item { padding: 10px; }
            .quiz-question { padding: 10px; }
            .question-text { font-size: 0.9rem; }
            .quiz-option { padding: 8px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <!-- SPLASH SCREEN -->
    <div id="splashScreen">
        <span class="splash-motif-top-left">&#x0950;</span> <!-- Om Symbol -->
        <h1 class="splash-title">Namaste AI</h1>
        <p class="splash-subtitle">Your innovative educational companion, fusing AI with the richness of Indian culture.</p>
        <div class="loading-circle"></div>
        <button id="splashContinueBtn" class="splash-continue-button">
            Enter Namaste AI <i class="fas fa-arrow-right"></i>
        </button>
        <span class="splash-motif-bottom-right">&#x0950;</span>
    </div>

    <div id="landingPage" class="landing-page">
        <div class="landing-container">
            <h1 class="namaste-ai-title">Namaste AI</h1>
            <p class="subtitle">Your innovative educational companion, fusing AI with the richness of Indian culture.</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-search-location"></i> </div>
                    <h3>Sanskriti Sync</h3>
                    <p>Discover your cultural connect through a fun quiz.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-book-open"></i> </div>
                    <h3>Itihaas Reimagined</h3>
                    <p>Explore alternate historical "What if" scenarios of India.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-comments"></i> </div> <!-- Changed icon for Past Patra -->
                    <h3>Past Patra</h3>
                    <p>Converse with AI personas of Indian historical figures for wisdom.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-om"></i> </div>
                    <h3>Mantrarth</h3>
                    <p>Uncover deep line-by-line meanings, cultural & historical context of ancient Sanskrit mantras.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fa-solid fa-monument"></i></div>
                    <h3>Monument Safari</h3>
                    <p>Explore the monuments spread across India and know some interesting facts about them with a quiz.</p>
                </div>
            </div>
            
            <button class="cta-button" onclick="showAuthPage()">
                Start Your Cultural Journey <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <div id="authPage" class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <h2 class="auth-title">Namaste AI</h2>
                <p>Unlock a world of Indian heritage and AI innovation.</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
            </div>
            
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-input" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-input" required placeholder="Enter your password">
                </div>
                <button type="submit" class="auth-button">
                    Login
                </button>
            </form>
            
            <form id="signupForm" class="auth-form" style="display: none;">
                <div class="form-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" class="form-input" required placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" class="form-input" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" class="form-input" required placeholder="Create a password">
                </div>
                <button type="submit" class="auth-button">
                    Sign Up
                </button>
            </form>
        </div>
    </div>

    <div id="mainApp" class="main-app">
        <header class="app-header">
            <div class="header-content">
                <div class="app-logo">Namaste AI</div>
                
                <nav class="nav-ribbon">
                    <button class="nav-tab active" data-tab="culture-match" onclick="switchTab('culture-match')">
                        <i class="fas fa-search-location"></i> Sanskriti Sync
                    </button>
                    <!-- Removed Culture Prophecy Tab -->
                    <button class="nav-tab" data-tab="itihaas-reimagined" onclick="switchTab('itihaas-reimagined')">
                        <i class="fas fa-book-open"></i> Itihaas Reimagined
                    </button>
                    <button class="nav-tab" data-tab="past-patra" onclick="switchTab('past-patra')">
                        <i class="fas fa-comments"></i> Past Patra
                    </button>
                    <button class="nav-tab" data-tab="mantrarth" onclick="switchTab('mantrarth')">
                        <i class="fas fa-om"></i> Mantrarth
                    </button>
                    <button class="nav-tab" data-tab="monument-safari" onclick="switchTab('monument-safari')">
                        <i class="fa-solid fa-monument"></i> Monument Safari
                    </button>
                </nav>
                
                <div class="user-section">
                    <span class="welcome-text" id="welcomeUserText"></span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>
        </header>
        
        <div class="app-content">
            <!-- Sanskriti Sync Content -->
            <div id="culture-match-content" class="tab-content active">
                <div class="sanskriti-sync-wrapper">
                    <h1 class="sanskriti-app-title">Sanskriti Sync</h1>
                    <p class="sanskriti-app-subtitle">Discover your cultural connect through your interests.</p>

                    <div id="sanskritiQuizScreen">
                        <!-- Category 1: Art & Craft -->
                        <div class="sanskriti-question-card" data-category="Art & Craft">
                            <div class="sanskriti-question-category">Category: Art & Craft</div>
                            <div class="sanskriti-question-text">Which art or craft forms intrigue you the most?</div>
                            <button class="sanskriti-option-button" data-value="Painting">Traditional Paintings (e.g., Madhubani, Warli)</button>
                            <button class="sanskriti-option-button" data-value="Sculpture">Sculpture & Stone Carving</button>
                            <button class="sanskriti-option-button" data-value="Textile Art">Textile & Weaving Arts (e.g., Silk, Embroidery)</button>
                            <button class="sanskriti-option-button" data-value="Pottery">Pottery & Terracotta</button>
                            <button class="sanskriti-option-button" data-value="Jewellery">Traditional Jewellery Making</button>
                            <button class="sanskriti-option-button" data-value="Folk Art">Vibrant Folk Art & Murals</button>
                            <button class="sanskriti-option-button" data-value="Performing Arts">Performing Arts (Drama, Theatre)</button>
                        </div>

                        <!-- Category 2: Food & Cuisine -->
                        <div class="sanskriti-question-card" data-category="Food & Cuisine">
                            <div class="sanskriti-question-category">Category: Food & Cuisine</div>
                            <div class="sanskriti-question-text">What culinary experiences excite your palate?</div>
                            <button class="sanskriti-option-button" data-value="Spicy Food">Bold & Spicy Flavors</button>
                            <button class="sanskriti-option-button" data-value="Sweet Desserts">Rich & Traditional Desserts</button>
                            <button class="sanskriti-option-button" data-value="Street Food">Diverse Street Food Delights</button>
                            <button class="sanskriti-option-button" data-value="Coastal Seafood">Fresh Coastal Seafood</button>
                            <button class="sanskriti-option-button" data-value="Vegetarian">Wholesome Vegetarian Dishes</button>
                            <button class="sanskriti-option-button" data-value="Breakfast">Hearty Breakfast Staples</button>
                            <button class="sanskriti-option-button" data-value="Thali">Grand Thali Meals</button>
                        </div>

                        <!-- Category 3: Festivals & Celebrations -->
                        <div class="sanskriti-question-card" data-category="Festivals & Celebrations">
                            <div class="sanskriti-question-category">Category: Festivals & Celebrations</div>
                            <div class="sanskriti-question-text">Which festive atmospheres do you enjoy participating in?</div>
                            <button class="sanskriti-option-button" data-value="Dance Festivals">Lively Dance Festivals (e.g., Navaratri)</button>
                            <button class="sanskriti-option-button" data-value="Harvest Festivals">Joyous Harvest Celebrations (e.g., Onam, Bihu)</button>
                            <button class="sanskriti-option-button" data-value="Religious Pilgrimages">Spiritual Pilgrimages & Fairs</button>
                            <button class="sanskriti-option-button" data-value="Light Festivals">Festivals of Lights & Colors (e.g., Diwali, Holi)</button>
                            <button class="sanskriti-option-button" data-value="Family Gatherings">Intimate Family Gatherings & Rituals</button>
                            <button class="sanskriti-option-button" data-value="Processions">Grand Public Processions</button>
                        </div>

                        <!-- Category 4: Music & Dance -->
                        <div class="sanskriti-question-card" data-category="Music & Dance">
                            <div class="sanskriti-question-category">Category: Music & Dance</div>
                            <div class="sanskriti-question-text">What styles of music and dance resonate with you?</div>
                            <button class="sanskriti-option-button" data-value="Classical Dance">Graceful Classical Dance (e.g., Kathak, Bharatanatyam)</button>
                            <button class="sanskriti-option-button" data-value="Folk Dance">Energetic Folk Dance (e.g., Bhangra, Garba)</button>
                            <button class="sanskriti-option-button" data-value="Carnatic Music">Soothing Carnatic Music</button>
                            <button class="sanskriti-option-button" data-value="Hindustani Music">Melodious Hindustani Classical Music</button>
                            <button class="sanskriti-option-button" data-value="Devotional Music">Soulful Devotional Music (Bhajans, Kirtans)</button>
                            <button class="sanskriti-option-button" data-value="Percussion">Rhythmic Percussion Instruments</button>
                        </div>

                        <!-- Category 5: Values & Philosophy -->
                        <div class="sanskriti-question-card" data-category="Values & Philosophy">
                            <div class="sanskriti-question-category">Category: Values & Philosophy</div>
                            <div class="sanskriti-question-text">What values or philosophical ideas do you connect with?</div>
                            <button class="sanskriti-option-button" data-value="Spirituality">Deep Spirituality & Meditation</button>
                            <button class="sanskriti-option-button" data-value="Community">Strong Community Bonds</button>
                            <button class="sanskriti-option-button" data-value="Harmony">Harmony with Nature</button>
                            <button class="sanskriti-option-button" data-value="Storytelling">Ancient Epics & Storytelling</button>
                            <button class="sanskriti-option-button" data-value="Family Values">Tradition & Family Values</button>
                            <button class="sanskriti-option-button" data-value="Resilience">Resilience & Adaptability</button>
                        </div>

                        <!-- Quiz Navigation -->
                        <div class="sanskriti-quiz-navigation">
                            <button id="sanskritiPrevButton" class="sanskriti-nav-button" disabled>Previous</button>
                            <button id="sanskritiNextButton" class="sanskriti-nav-button">Next</button>
                        </div>

                        <button id="sanskritiShowCultureButton" class="sanskriti-cta-button" style="display: none;">Show My Culture</button>
                    </div>

                    <div id="sanskritiResultScreen" class="sanskriti-result-screen">
                        <h2 class="sanskriti-result-title">Your Cultural Matches!</h2>
                        <div id="sanskritiCulturalTraditionsGrid" class="sanskriti-cultural-traditions-grid">
                            <!-- Results will be dynamically inserted here by JavaScript -->
                        </div>
                        <p id="sanskritiNoResultsMessage" class="sanskriti-no-results-message" style="display: none;">
                            No traditions matched your current selections. Try different combinations or explore more options!
                        </p>
                        <button class="sanskriti-cta-button" onclick="sanskritiResetQuiz()" style="margin-top: 40px;">Explore Again</button>
                    </div>
                </div>
            </div>

            <!-- Itihaas Reimagined Content -->
            <div id="itihaas-reimagined-content" class="tab-content">
                <div class="itihaas-reimagined-container">
                    <div class="itihaas-title-card">
                        <i class="fas fa-scroll icon-seal"></i>
                        <h2>Itihaas Reimagined</h2>
                    </div>
                    <p class="itihaas-description">
                        Explore fascinating "What if" scenarios rooted in Indian civilization. Reflect on how different the present might be if pivotal historical events had turned out differently.
                    </p>

                    <select id="whatIfSelector" class="what-if-selector">
                        <option value="">Select a "What if" scenario...</option>
                        <option value="What if the Indus Valley Civilization had evolved into a tech-driven empire?">What if the Indus Valley Civilization had evolved into a tech-driven empire?</option>
                        <option value="What if the Mughals and Marathas had formed an alliance instead of warring?">What if the Mughals and Marathas had formed an alliance instead of warring?</option>
                        <option value="What if Nalanda University was never destroyed and continued to flourish?">What if Nalanda University was never destroyed and continued to flourish?</option>
                        <option value="What if India was never colonized by European powers?">What if India was never colonized by European powers?</option>
                        <option value="What if Buddhism remained the dominant religion across India?">What if Buddhism remained the dominant religion across India?</option>
                        <option value="What if Ashoka the Great had not embraced Buddhism?">What if Ashoka the Great had not embraced Buddhism?</option>
                        <option value="What if the Gupta Empire had never declined and continued its golden age?">What if the Gupta Empire had never declined and continued its golden age?</option>
                        <option value="What if the Indian Rebellion of 1857 had succeeded in fully overthrowing British rule?">What if the Indian Rebellion of 1857 had succeeded in fully overthrowing British rule?</option>
                        <option value="What if Sanskrit remained the primary lingua franca of the Indian subcontinent?">What if Sanskrit remained the primary lingua franca of the Indian subcontinent?</option>
                        <option value="What if ancient Indian mathematical discoveries (like zero) were globally adopted much earlier?">What if ancient Indian mathematical discoveries (like zero) were globally adopted much earlier?</option>
                        <option value="What if Alexander the Great's empire extended deeper into India and endured?">What if Alexander the Great's empire extended deeper into India and endured?</option>
                        <option value="What if the Chola Empire had expanded its maritime trade dominance globally?">What if the Chola Empire had expanded its maritime trade dominance globally?</option>
                        <option value="What if the Delhi Sultanate had successfully unified all of India under one rule for centuries?">What if the Delhi Sultanate had successfully unified all of India under one rule for centuries?</option>
                        <option value="What if Guru Gobind Singh had successfully established a unified Sikh empire across North India?">What if Guru Gobind Singh had successfully established a unified Sikh empire across North India?</option>
                        <option value="What if Tipu Sultan's kingdom had successfully resisted British expansion in South India?">What if Tipu Sultan's kingdom had successfully resisted British expansion in South India?</option>
                        <option value="What if the Harappan script had been deciphered in ancient times, leading to greater knowledge exchange?">What if the Harappan script had been deciphered in ancient times, leading to greater knowledge exchange?</option>
                        <option value="What if the Bhakti movement had led to a complete societal restructuring based on equality?">What if the Bhakti movement had led to a complete societal restructuring based on equality?</option>
                        <option value="What if the ancient Indian caste system had never developed or was abolished much earlier?">What if the ancient Indian caste system had never developed or was abolished much earlier?</option>
                        <option value="What if India developed advanced gunpowder technology independently before European contact?">What if India developed advanced gunpowder technology independently before European contact?</option>
                        <option value="What if the ancient Indian trade routes (Silk Road, spice routes) were exclusively controlled by Indian powers for millennia?">What if the ancient Indian trade routes (Silk Road, spice routes) were exclusively controlled by Indian powers for millennia</option>
                        <option value="What if Mahatma Gandhi had pursued armed resistance instead of non-violence?">What if Mahatma Gandhi had pursued armed resistance instead of non-violence?</option>
                        <option value="What if the Partition of India never happened?">What if the Partition of India never happened?</option>
                    </select>

                            <button id="generateScenarioBtn" class="generate-btn">Generate Scenario</button>

                            <div id="itihaasLoading" class="itihaas-loading">
                                <div class="itihaas-spinner"></div>
                                <p>Generating alternate history...</p>
                            </div>

                            <div id="narrativeResult" class="narrative-result">
                                <!-- Generated narrative will appear here -->
                            </div>
                        </div>
                    </div>

                    <!-- Past Patra Content (NEW) -->
                    <div id="past-patra-content" class="tab-content">
                        <div class="past-patra-container">
                            <div class="patra-header">
                                <h2 class="patra-title">Past Patra – Echoes of Wisdom</h2>
                                <p class="patra-description">
                                    Converse with AI personas of legendary Indian figures. Each reply is a 'Patra' (letter) from the past, guiding a modern mind with timeless wisdom.
                                </p>
                            </div>
                            <div class="patra-content-wrapper">
                                <div class="personality-selector-column" id="personalitySelector">
                                    <!-- Personality buttons will be injected here by JavaScript -->
                                    <button class="personality-button" data-personality="Chanakya">
                                        <i class="fas fa-brain"></i> Chanakya
                                    </button>
                                    <button class="personality-button" data-personality="Ashoka the Great">
                                        <i class="fas fa-leaf"></i> Ashoka the Great
                                    </button>
                                    <button class="personality-button" data-personality="Aryabhata">
                                        <i class="fas fa-calculator"></i> Aryabhata
                                    </button>
                                    <button class="personality-button" data-personality="Kalidasa">
                                        <i class="fas fa-feather-alt"></i> Kalidasa
                                    </button>
                                    <button class="personality-button" data-personality="Charaka">
                                        <i class="fas fa-stethoscope"></i> Charaka
                                    </button>
                                    <button class="personality-button" data-personality="Sushruta">
                                        <i class="fas fa-scalpel"></i> Sushruta
                                    </button>
                                    <button class="personality-button" data-personality="Panini">
                                        <i class="fas fa-language"></i> Panini
                                    </button>
                                    <button class="personality-button" data-personality="Gautama Buddha">
                                        <i class="fas fa-om"></i> Gautama Buddha
                                    </button>
                                    <button class="personality-button" data-personality="Mahavira">
                                        <i class="fas fa-hand-holding-heart"></i> Mahavira
                                    </button>
                                    <button class="personality-button" data-personality="Patanjali">
                                        <i class="fas fa-praying-hands"></i> Patanjali
                                    </button>
                                    <button class="personality-button" data-personality="Adi Shankara">
                                        <i class="fas fa-book-reader"></i> Adi Shankara
                                    </button>
                                    <button class="personality-button" data-personality="Ramanujacharya">
                                        <i class="fas fa-scroll"></i> Ramanujacharya
                                    </button>
                                    <button class="personality-button" data-personality="Raja Raja Chola I">
                                        <i class="fas fa-crown"></i> Raja Raja Chola I
                                    </button>
                                    <button class="personality-button" data-personality="Bhaskara II">
                                        <i class="fas fa-atom"></i> Bhaskara II
                                    </button>
                                    <button class="personality-button" data-personality="Prithviraj Chauhan">
                                        <i class="fas fa-shield-alt"></i> Prithviraj Chauhan
                                    </button>
                                    <button class="personality-button" data-personality="Kabir">
                                        <i class="fas fa-pray"></i> Kabir
                                    </button>
                                    <button class="personality-button" data-personality="Guru Nanak Dev">
                                        <i class="fas fa-hands-helping"></i> Guru Nanak Dev
                                    </button>
                                    <button class="personality-button" data-personality="Mirabai">
                                        <i class="fas fa-music"></i> Mirabai
                                    </button>
                                    <button class="personality-button" data-personality="Amir Khusrau">
                                        <i class="fas fa-microphone-alt"></i> Amir Khusrau
                                    </button>
                                    <button class="personality-button" data-personality="Queen Didda">
                                        <i class="fas fa-chess-queen"></i> Queen Didda
                                    </button>
                                </div>
                                <div class="chat-area-column">
                                    <div class="chat-panel" id="patraChatPanel">
                                        <!-- Chat messages will appear here -->
                                        <div class="ai-message chat-bubble">
                                            Namaste! I am here to share insights from the annals of time. Whom would you like to converse with today?
                                        </div>
                                    </div>

                                    <div class="chat-input-area">
                                        <textarea id="patraMessageInput" class="message-input" placeholder="Ask your question..."></textarea>
                                        <button id="patraSendMessageBtn" class="send-button">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="patra-loading-spinner" id="patraLoadingSpinner">
                                        <div class="spinner"></div>
                                        <p>Meditating on your query...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mantrarth Content (NEWLY ADDED) -->
                    <div id="mantrarth-content" class="tab-content">
                        <div class="mantrarth-container">
                            <div class="mantrarth-header">
                                <h2 class="mantrarth-title">Mantrarth – Unveiling Ancient Wisdom</h2>
                                <p class="mantrarth-description">Uncover the deep line-by-line meanings, cultural, and historical context of ancient Sanskrit mantras.</p>
                            </div>

                            <!-- Mantra List Screen -->
                            <div id="mantraListScreen" class="mantra-list-screen">
                                <div class="mantra-list" id="mantraList">
                                    <!-- Mantra cards will be dynamically loaded here by JavaScript -->
                                </div>
                            </div>

                            <!-- Mantra Detail Screen (initially hidden) -->
                            <div id="mantraDetailScreen" class="mantra-detail-screen" style="display: none;">
                                <div class="back-button-container">
                                    <button class="back-btn" id="backToMantraList">
                                        <i class="fas fa-arrow-left"></i> Back to Mantras
                                    </button>
                                </div>
                                <div class="mantra-detail-content" id="mantraDetailContent">
                                    <h2 id="detailMantraTitle"></h2>
                                    <div class="mantra-text-block">
                                        <p class="original-script" id="detailOriginalScript"></p>
                                        <p class="transliteration" id="detailTransliteration"></p>
                                        <p class="full-meaning-text" id="detailFullMeaning"></p>
                                    </div>
                                    <div class="mantra-cultural-context" id="detailCulturalContext">
                                        <h3>Cultural & Historical Context</h3>
                                        <!-- Context will be populated here -->
                                    </div>
                                    <div class="mantra-audio-controls">
                                        <button class="play-pause-btn" id="playPauseMantraBtn">
                                            <i class="fas fa-play"></i> Play Mantra
                                        </button>
                                        <button class="stop-mantra-btn" id="stopMantraBtn">
                                            <i class="fas fa-stop"></i> Stop
                                        </button>
                                        <div class="mantra-visual-effect"></div>
                                    </div>
                                    <div id="mantraLoadingSpinner" class="mantra-loading-spinner" style="display:none;">
                                        <div class="spinner"></div>
                                        <p>Unraveling wisdom...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Monument Safari Content (Existing in your provided file) -->
                    <div id="monument-safari-content" class="tab-content">
                        <div class="monument-safari-container">
                            <div class="game-title">🏛️ Monument Safari</div>
                            <div class="badge-display">🏆 Badge Earned: <span id="badge-display">None</span></div>

                            <div class="game-container">
                                <div class="india-map">
                                    <div class="map-outline" id="map-outline">
                                        <svg class="india-shape" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M790.6,303.6c-13.8-31.5-23-64.8-23.7-98.7c-0.3-13.5-3.3-26.8-9.4-38.9c-10-19.8-27-33-47.5-39.7c-20.4-6.7-42.5-5.3-62.8-1.7c-20.3,3.6-39.4,11.2-56.9,23.3c-17.5,12.1-33.3,28-46.7,46.5c-13.4,18.5-24.6,39.6-33.3,62c-8.7,22.4-15,46-18.7,70.1c-3.7,24.1-4.8,48.5-3.3,72.7c1.5,24.2,6.4,48.2,14.6,71.5c8.2,23.4,19.8,45.8,34.4,66.8c14.6,21,32.3,40.6,52.5,57.7c20.2,17.1,43,31.7,67.6,42.8c24.6,11.1,50.9,18.7,77.9,21.8c27,3.1,54.7,1.8,81.8-3.9c27.1-5.7,53.7-16.1,78.8-31.2c25.1-15.1,48.8-34.9,70.2-59.5c21.4-24.6,40.4-53.9,56.5-87.8c16.1-33.9,29.2-72.3,39.1-114c9.9-41.7,16.7-87.9,20.3-136.9c3.6-49.1,3.8-100,0.6-152.1c-3.1-52.1-9.9-105.4-20.2-159.2c-10.4-53.8-24.9-108.2-43.5-162.1c-18.6-53.9-41.4-108.4-68-161.4c-26.6-53.1-57.7-105.4-92.9-155.8c-35.2-50.4-74.5-98.8-118-144.1c-43.5-45.3-91.1-87.5-142-125.6c-50.9-38.1-104.9-71.9-161.5-100.9c-56.6-29-115.8-53.1-176.9-72c-61.1-18.9-123.9-32.8-187.9-41.6c-64-8.8-129.2-12.4-194.9-10.6c-65.7,1.8-131.7,9.3-197.6,22.4c-65.9,13.1-131.9,31.8-197.5,55.8c-65.6,24-130.6,53.3-194.6,87.7c-64,34.4-126,74.2-185.3,119.8c-59.3,45.6-115.8,96.5-168.9,152.5c-53.1,56-102.8,117.3-148.5,183.5c-45.7,66.2-87.3,137.4-124.7,212.8c-37.5,75.4-70.8,155-99.8,237.9c-29,82.9-53.8,169.3-73.8,258.4c-20,89.1-35.1,180.7-45.3,274c-10.2,93.3-15.4,188.3-15.4,284.1c0,95.8,4.7,192.6,14.1,289.4c9.4,96.8,23.4,193.6,42,289.2c18.6,95.7,41.9,190.9,69.5,284.6c27.6,93.7,59.5,185.9,95.4,275.9c35.9,90,75.7,177.9,119.3,263.3c43.6,85.4,90.9,168.4,141.6,248.5c50.7,80.1,104.7,157.2,161.8,230.9c57.1,73.7,117.7,144.1,181,210.6c63.3,66.6,129.9,129.4,199.6,188.4c69.7,59,142.4,114.1,217.7,165c75.3,50.9,153.2,97.7,233.5,140.2c80.3,42.5,163,80.6,247.7,114.2c84.7,33.6,170.3,62.7,256.7,87.1c86.4,24.4,173.3,44.2,259.9,59.3c86.6,15.1,172.9,25.6,258.9,31.3c86,5.7,171.6,5.7,255.9,0c84.3-5.7,167.5-17,249.2-33.8c81.7-16.8,161.8-39.2,240.2-66.9c78.4-27.7,155-60.8,229.4-98.9c74.4-38.1,146.8-81.2,216.7-128.8c69.9-47.6,137.3-99.7,201.9-155.8c64.6-56.1,126.4-116.3,185.2-180.2c58.8-63.9,114.6-131.6,167.3-202.9c52.7-71.3,102.9-145.9,149-223.7c46.1-77.8,88.1-158.7,125.7-242.3c37.6-83.7,70.8-170,99.3-258.6c28.5-88.7,52.4-179.4,70.9-271.8c18.5-92.4,31.4-186.6,38.6-282c7.2-95.4,8.8-191.7,5-288.6c-3.8-96.9-12.1-194.4-25-292.1c-12.9-97.7-30.4-195.6-52.1-293.4c-21.7-97.8-47.9-195.6-78.2-293c-30.3-97.4-64.8-194.2-103.2-290.1c-38.4-95.9-80.9-191.1-127-285.3c-46.2-94.2-95.9-187.3-148.9-278.9c-53.1-91.6-109.5-182.1-168.9-270.3c-59.4-88.2-121.7-174.2-186.7-257.6c-65-83.4-132.5-164.2-202.1-242.1c-69.6-77.9-141.1-152.9-214.3-225c-73.2-72.1-148.1-141.3-224.2-207.3C498.4,103.8,453.6,104.9,409,100z" transform="scale(0.8) translate(100, 100)"/>
                                        </svg>

                                        <svg width="100%" height="100%" id="path-svg"></svg>
                                    </div>
                                </div>

                                <div class="game-stats">
                                    <strong>Current Location:</strong> <span id="current-location">Red Fort, Delhi</span><br>
                                    <strong>Monuments Visited:</strong> <span id="visited-count">0</span>/<span id="total-monuments">15</span><br>
                                    <strong>Last Roll:</strong> <span id="last-roll"></span>
                                </div>

                                <div class="game-controls">
                                    <div class="dice-container">
                                        <div class="dice" id="dice">🎲</div>
                                        <button class="roll-btn" id="roll-btn" onclick="rollDice()">Roll Dice</button>
                                    </div>
                                </div>

                                <button class="know-about-btn" id="know-about-btn" onclick="openMonumentModal()">
                                    Know About <span id="current-monument-name">Red Fort</span>
                                </button>
                            </div>
                            
                            <div id="monument-modal" class="modal">
                                <div class="modal-content">
                                    <span class="close" onclick="closeModal()">&times;</span>
                                    <div id="modal-content">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
            <script>
                /*
                ====================================================================
                EMAILJS SETUP - READY TO USE!
                ====================================================================
                */
                let emailJSReady = false;
                function initEmailJS() {
                    let attempts = 0;
                    const maxAttempts = 5;
                    function tryInit() {
                        attempts++;
                        console.log(`[EmailJS] Attempting to initialize EmailJS (attempt ${attempts}/${maxAttempts})`);
                        if (typeof emailjs !== 'undefined' && emailjs.init) {
                            try {
                                emailjs.init("WIznO3akpAGsZw5TG");
                                emailJSReady = true;
                                console.log('[EmailJS] ✅ EmailJS loaded successfully - ready to send real emails!');
                                console.log('[EmailJS] 📧 Emails will be sent to wanderingsoul.fs12@gmail.com');
                                return true;
                            } catch (error) {
                                console.log('[EmailJS] ❌ EmailJS init failed:', error);
                            }
                        } else if (window.emailjs && window.emailjs.init) {
                            try {
                                window.emailjs.init("WIznO3akpAGsZw5TG");
                                emailJSReady = true;
                                console.log('[EmailJS] ✅ EmailJS loaded successfully via window object!');
                                console.log('[EmailJS] 📧 Emails will be sent to wanderingsoul.fs12@gmail.com');
                                return true;
                            }
                            catch (error) {
                                console.log('[EmailJS] ❌ Window EmailJS init failed:', error);
                            }
                        }
                        if (attempts < maxAttempts) {
                            console.log(`[EmailJS] ⏳ EmailJS not ready yet, retrying in ${attempts * 200}ms...`);
                            setTimeout(tryInit, attempts * 200);
                        } else {
                            console.log('[EmailJS] ⚠️  EmailJS failed to load after multiple attempts - using demo mode');
                            setupDemoMode();
                        }
                        return false;
                    }
                    tryInit();
                }
                function setupDemoMode() {
                    window.emailjs = {
                        send: function(serviceId, templateId, params) {
                            return new Promise((resolve) => {
                                console.log('[EmailJS] 📧 DEMO MODE: Email data captured:', params);
                                console.log('[EmailJS] 📧 In real mode, this would be sent to wanderingsoul.fs12@gmail.com');
                                setTimeout(() => resolve({ status: 200, text: 'DEMO_SUCCESS' }), 1500);
                            });
                        }
                    };
                }
                
                // --- Core Screen and Tab Management ---
                const splashScreen = document.getElementById('splashScreen');
                const landingPage = document.getElementById('landingPage');
                const authPage = document.getElementById('authPage');
                const mainApp = document.getElementById('mainApp');
                const splashContinueBtn = document.getElementById('splashContinueBtn'); // New button element

                const authTabs = document.querySelectorAll('.auth-tab');
                const loginForm = document.getElementById('loginForm');
                const signupForm = document.getElementById('signupForm');

                const navTabs = document.querySelectorAll('.nav-tab');
                const tabContents = document.querySelectorAll('.tab-content');
                const welcomeUserText = document.getElementById('welcomeUserText');

                let currentUsername = "User";

                function showScreen(screenToShow) {
                    console.log(`[ScreenControl] Attempting to show: ${screenToShow}`);
                    // Hide all main screens first
                    landingPage.style.display = 'none';
                    authPage.style.display = 'none';
                    mainApp.style.display = 'none';
                    splashScreen.style.display = 'none'; // Ensure splash is hidden when showing other screens

                    // Show the requested screen
                    if (screenToShow === 'landingPage') {
                        landingPage.style.display = 'flex';
                        console.log("[ScreenControl] Landing page display set to flex.");
                    } else if (screenToShow === 'authPage') {
                        authPage.style.display = 'flex';
                        console.log("[ScreenControl] Auth page display set to flex.");
                    } else if (screenToShow === 'mainApp') {
                        mainApp.style.display = 'block';
                        console.log("[ScreenControl] Main app display set to block.");
                    }
                }

                function switchAuthTab(tabName) {
                    authTabs.forEach(tab => tab.classList.remove('active'));
                    if (tabName === 'login') {
                        document.querySelector('.auth-tab[onclick="switchAuthTab(\'login\')"]').classList.add('active');
                        loginForm.style.display = 'block';
                        signupForm.style.display = 'none';
                    } else {
                        document.querySelector('.auth-tab[onclick="switchAuthTab(\'signup\')"]').classList.add('active');
                        loginForm.style.display = 'none';
                        signupForm.style.display = 'block';
                    }
                }

                function switchTab(tabId) {
                    navTabs.forEach(tab => tab.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));

                    document.querySelector(`.nav-tab[data-tab="${tabId}"]`).classList.add('active');
                    document.getElementById(`${tabId}-content`).classList.add('active');

                    if (tabId === 'culture-match') { // This is now Sanskriti Sync
                        sanskritiResetQuiz();
                    } else if (tabId === 'past-patra') { // Initialize Past Patra
                        // Optional: Select a default personality or clear chat
                        patraChatPanel.innerHTML = '<div class="ai-message chat-bubble">Namaste! I am here to share insights from the annals of time. Whom would you like to converse with today?</div>';
                        pastPatraChatHistory = []; // Clear chat history
                        currentPersonality = null; // Clear selected personality
                        document.querySelectorAll('.personality-button').forEach(btn => btn.classList.remove('selected'));
                    } else if (tabId === 'mantrarth') { // Initialize Mantrarth
                        displayMantraList();
                        stopMantraAudio(); // Stop any playing audio when switching tabs
                    } else if (tabId === 'monument-safari') { // Initialize Monument Safari
                        createMonumentMarkers();
                        createPath();
                        createPlayerToken();
                        updateGameStats();
                    }
                    // Add other tab-specific initializations here if needed
                }

                function showAuthPage() {
                    showScreen('authPage');
                    switchAuthTab('login');
                }

                loginForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    const email = document.getElementById('loginEmail').value;
                    currentUsername = email.split('@')[0];
                    welcomeUserText.textContent = `Welcome, ${currentUsername}!`;
                    showScreen('mainApp');
                    switchTab('culture-match');
                });

                signupForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    const username = document.getElementById('signupName').value;
                    const email = document.getElementById('signupEmail').value;
                    const phone = document.getElementById('signupPhone') ? document.getElementById('signupPhone').value : 'N/A';

                    const templateParams = {
                        username: username,
                        phone: phone,
                        email: email,
                        timestamp: new Date().toLocaleString(),
                        to_email: 'wanderingsoul.fs12@gmail.com'
                    };

                    emailjs.send('service_u4qtc8f', 'namastey_signup', templateParams)
                        .then(function(response) {
                            console.log('Email sent successfully!', response.status, response.text);
                            currentUsername = username;
                            welcomeUserText.textContent = `Welcome, ${currentUsername}!`;
                            showScreen('mainApp');
                            switchTab('culture-match');
                        }, function(error) {
                            console.log('Email sending failed:', error);
                            currentUsername = username;
                            welcomeUserText.textContent = `Welcome, ${currentUsername}!`;
                            showScreen('mainApp');
                            switchTab('culture-match');
                        });
                });

                function logout() {
                    currentUsername = "User";
                    showScreen('landingPage');
                }

                // --- SPLASH SCREEN LOGIC ---
                document.addEventListener('DOMContentLoaded', () => {
                    console.log("[AppInit] DOMContentLoaded event fired.");
                    // Initially ensure splash screen is visible and others are hidden
                    splashScreen.style.display = 'flex'; 
                    landingPage.style.display = 'none';
                    authPage.style.display = 'none';
                    mainApp.style.display = 'none';
                    console.log("[AppInit] Splash screen displayed. Waiting for user interaction.");

                    // Add event listener to the new button
                    splashContinueBtn.addEventListener('click', () => {
                        console.log("[AppInit] Splash continue button clicked.");
                        splashScreen.style.display = 'none'; // Hide splash screen
                        showScreen('landingPage'); // Show landing page
                        initEmailJS(); // Initialize EmailJS
                    });
                });


                // --- Itihaas Reimagined Logic ---
                const whatIfSelector = document.getElementById('whatIfSelector');
                const generateScenarioBtn = document.getElementById('generateScenarioBtn');
                const itihaasLoading = document.getElementById('itihaasLoading');
                const narrativeResult = document.getElementById('narrativeResult');

                async function generateItihaasScenario(promptText) {
                    itihaasLoading.style.display = 'block';
                    narrativeResult.classList.remove('active');

                    const prompt = `As an expert in Indian history and culture, create a detailed alternate history narrative for the scenario: '${promptText}'. Focus on how Indian culture, society, art, language, and politics might have evolved over centuries due to this change. Provide specific, imaginative details across these domains. Your response should be a well-structured narrative, starting directly with the story.`;

                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    // API Key changed back for user to insert
                    const apiKey = "AIzaSyAOXmXJsW101veTz1O5cFpXsK0wnkRQRQY"; // Change this to your actual API key

                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        const result = await response.json();
                        console.log("Gemini API Response:", result);

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            narrativeResult.innerHTML = `<p>${text.replace(/\n/g, '<br>')}</p>`;
                            narrativeResult.classList.add('active');
                        } else {
                            // Log the full error response for debugging
                            console.error('API response did not contain expected content:', result);
                            narrativeResult.innerHTML = '<p>Failed to generate narrative. No valid response from AI. Please try again.</p>';
                            narrativeResult.classList.add('active');
                        }
                    } catch (error) {
                        console.error('Error calling Gemini API:', error);
                        narrativeResult.innerHTML = '<p>An error occurred while generating the narrative. Please check your network connection and API key. Error: ' + error.message + '</p>';
                        narrativeResult.classList.add('active');
                        // For debugging: show error in console and potentially on screen
                        console.log("API Key used:", apiKey ? "Provided" : "Not Provided");
                        console.log("API URL:", apiUrl);
                    } finally {
                        itihaasLoading.style.display = 'none';
                    }
                }

                generateScenarioBtn.addEventListener('click', () => {
                    const selectedScenario = whatIfSelector.value;
                    if (selectedScenario) {
                        generateItihaasScenario(selectedScenario);
                    } else {
                        narrativeResult.innerHTML = '<p>Please select a "What if" scenario from the dropdown.</p>';
                        narrativeResult.classList.add('active');
                    }
                });

                whatIfSelector.addEventListener('change', () => {
                    narrativeResult.innerHTML = '';
                    narrativeResult.classList.remove('active');
                    itihaasLoading.style.display = 'none';
                });

                // --- Sanskriti Sync Logic (Integrated) ---
                const sanskritiQuizScreen = document.getElementById('sanskritiQuizScreen');
                const sanskritiResultScreen = document.getElementById('sanskritiResultScreen');
                const sanskritiQuestionCards = document.querySelectorAll('.sanskriti-question-card');
                const sanskritiPrevButton = document.getElementById('sanskritiPrevButton');
                const sanskritiNextButton = document.getElementById('sanskritiNextButton');
                const sanskritiShowCultureButton = document.getElementById('sanskritiShowCultureButton');
                const sanskritiCulturalTraditionsGrid = document.getElementById('sanskritiCulturalTraditionsGrid');
                const sanskritiNoResultsMessage = document.getElementById('sanskritiNoResultsMessage');

                let sanskritiCurrentQuestionIndex = 0;
                let sanskritiSelectedInterests = new Set();

                const culturalData = [
                    { name: "Garba & Dandiya", region: "Gujarat", description: "Vibrant folk dances performed during Navaratri, celebrating the goddess Durga with energetic movements.", categories: ["Dance Festivals", "Folk Dance", "Family Gatherings"], interests: ["Dance", "Festivals", "Community", "Percussion"] },
                    { name: "Kathak", region: "Uttar Pradesh", description: "A classical North Indian dance known for intricate footwork, graceful spins, and storytelling through expressions.", categories: ["Classical Dance", "Performing Arts"], interests: ["Dance", "Storytelling", "Art", "Hindustani Music"] },
                    { name: "Onam Sadya", region: "Kerala", description: "A grand vegetarian feast served on a banana leaf, central to the Onam harvest festival.", categories: ["Harvest Festivals", "Vegetarian", "Coastal Seafood", "Family Gatherings"], interests: ["Festivals", "Cuisine", "Community", "Harmony", "Breakfast"] },
                    { name: "Madhubani Painting", region: "Bihar", description: "A traditional folk art form characterized by intricate geometric patterns, vibrant colors, and mythological themes.", categories: ["Painting", "Folk Art", "Textile Art"], interests: ["Art", "Folk Art", "Storytelling", "Textile Art"] },
                    { name: "Diwali Celebrations", region: "Pan-India", description: "The Festival of Lights, symbolizing the victory of light over darkness and good over evil, celebrated with lamps, fireworks, and sweets.", categories: ["Light Festivals", "Family Gatherings", "Sweet Desserts"], interests: ["Festivals", "Family Values", "Community", "Sweet Desserts"] },
                    { name: "Rajasthani Thali", region: "Rajasthan", description: "A platter offering a variety of dishes including dal baati churma, gatte ki sabzi, and local breads, reflecting desert cuisine.", categories: ["Thali", "Spicy Food", "Vegetarian"], interests: ["Cuisine", "Spicy Food", "Thali"] },
                    { name: "Bharatanatyam", region: "Tamil Nadu", description: "A classical South Indian dance form known for its precise movements, expressive gestures, and spiritual themes.", categories: ["Classical Dance", "Performing Arts"], interests: ["Dance", "Spirituality", "Art", "Carnatic Music"] },
                    { name: "Holi", region: "Pan-India", description: "The Festival of Colors, celebrated with playful throwing of colored powders and water, signifying the arrival of spring.", categories: ["Light Festivals", "Family Gatherings", "Processions"], interests: ["Festivals", "Community", "Joy", "Colors"] },
                    { name: "Dussehra/Vijayadashami", region: "Pan-India", description: "Celebrates the victory of good over evil, often marked by effigies of Ravana being burned and Ramleela performances.", categories: ["Religious Pilgrimages", "Performing Arts", "Storytelling", "Processions"], interests: ["Festivals", "Storytelling", "Community", "Drama"] },
                    { name: "Durga Puja", region: "West Bengal", description: "A grand festival celebrating the goddess Durga, featuring elaborate pandals, cultural performances, and feasts.", categories: ["Religious Pilgrimages", "Dance Festivals", "Family Gatherings", "Performing Arts"], interests: ["Festivals", "Community", "Art", "Sculpture", "Food", "Music"] },
                    { name: "Chhau Dance", region: "Eastern India (Odisha, Jharkhand, West Bengal)", description: "A semi-classical Indian dance with martial, tribal, and folk origins, known for its masked dancers and athletic movements.", categories: ["Folk Dance", "Performing Arts"], interests: ["Dance", "Performing Arts", "Storytelling"] },
                    { name: "Bihu", region: "Assam", description: "A set of three important Assamese festivals, celebrating agriculture and new beginnings with lively folk dances and songs.", categories: ["Harvest Festivals", "Folk Dance", "Family Gatherings"], interests: ["Festivals", "Community", "Folk Dance"] },
                    { name: "Kerala's Backwater Cuisine", region: "Kerala", description: "Dishes featuring fresh seafood and coconut, reflecting the unique geography of Kerala's backwaters.", categories: ["Coastal Seafood", "Spicy Food"], interests: ["Cuisine", "Coastal Seafood", "Spicy Food", "Harmony"] },
                    { name: "Ganesha Chaturthi", region: "Maharashtra", description: "A popular Hindu festival celebrating the birth of Ganesha, featuring grand public installations and processions.", categories: ["Religious Pilgrimages", "Processions", "Family Gatherings"], interests: ["Festivals", "Community", "Art", "Sculpture"] },
                    { name: "Ayurveda & Traditional Healing", region: "Pan-India", description: "Ancient system of medicine with a holistic approach to health, focusing on balance and natural remedies.", categories: ["Harmony", "Spirituality", "Philosophy"], interests: ["Harmony", "Spirituality", "Wellness", "Philosophy"] },
                    { name: "Indian Classical Music (Hindustani/Carnatic)", region: "Pan-India", description: "Rich musical traditions rooted in ancient scriptures, known for their melodic beauty and intricate rhythmic structures.", categories: ["Hindustani Music", "Carnatic Music", "Devotional Music"], interests: ["Music", "Classical Music", "Devotional Music", "Spirituality"] },
                    { name: "Kathakali", region: "Kerala", description: "A highly stylized classical Indian dance-drama known for its elaborate costumes, vibrant makeup, and dramatic storytelling.", categories: ["Performing Arts", "Classical Dance", "Storytelling"], interests: ["Dance", "Performing Arts", "Storytelling", "Art"] },
                    { name: "Yoga & Meditation", region: "Pan-India", description: "Ancient Indian practices for physical, mental, and spiritual well-being, emphasizing harmony and inner peace.", categories: ["Spirituality", "Harmony", "Philosophy"], interests: ["Spirituality", "Harmony", "Wellness", "Philosophy", "Meditation"] },
                    { name: "Street Food of Delhi", region: "Delhi", description: "A culinary journey through diverse and flavorful snacks like Chole Bhature, Parathas, and Jalebis.", categories: ["Street Food", "Spicy Food", "Sweet Desserts"], interests: ["Cuisine", "Street Food", "Spicy Food", "Sweet Desserts", "Breakfast"] },
                    { name: "Varanasi Ganga Aarti", region: "Uttar Pradesh", description: "A mesmerizing Hindu religious ritual of worship, performed daily at sunset on the Dashashwamedh Ghat, with lamps and hymns.", categories: ["Religious Pilgrimages", "Devotional Music", "Processions", "Spirituality"], interests: ["Spirituality", "Festivals", "Community", "Devotional Music"] },
                    { name: "Warli Painting", region: "Maharashtra", description: "Tribal art form creating simplistic linear figures to depict daily life, rituals, and nature.", categories: ["Folk Art", "Painting", "Harmony"], interests: ["Art", "Folk Art", "Harmony", "Community"] },
                    { name: "Bhangra", region: "Punjab", description: "A lively and energetic folk dance that originated in the Punjab region, often performed during harvest festivals like Baisakhi.", categories: ["Folk Dance", "Harvest Festivals", "Percussion"], interests: ["Dance", "Folk Dance", "Festivals", "Percussion"] }
                ];

                function sanskritiShowQuestion(index) {
                    sanskritiQuestionCards.forEach((card, i) => {
                        if (i === index) {
                            card.classList.add('active');
                        } else {
                            card.classList.remove('active');
                        }
                    });
                    sanskritiUpdateNavigationButtons();
                }

                function sanskritiUpdateNavigationButtons() {
                    sanskritiPrevButton.disabled = sanskritiCurrentQuestionIndex === 0;
                    sanskritiNextButton.disabled = sanskritiCurrentQuestionIndex === sanskritiQuestionCards.length - 1;

                    if (sanskritiCurrentQuestionIndex === sanskritiQuestionCards.length - 1) {
                        sanskritiShowCultureButton.style.display = 'block';
                        sanskritiNextButton.style.display = 'none';
                    } else {
                        sanskritiShowCultureButton.style.display = 'none';
                        sanskritiNextButton.style.display = 'block';
                    }
                }

                sanskritiPrevButton.addEventListener('click', () => {
                    if (sanskritiCurrentQuestionIndex > 0) {
                        sanskritiCurrentQuestionIndex--;
                        sanskritiShowQuestion(sanskritiCurrentQuestionIndex);
                    }
                });

                sanskritiNextButton.addEventListener('click', () => {
                    if (sanskritiCurrentQuestionIndex < sanskritiQuestionCards.length - 1) {
                        sanskritiCurrentQuestionIndex++;
                        sanskritiShowQuestion(sanskritiCurrentQuestionIndex);
                    }
                });

                sanskritiQuestionCards.forEach(card => {
                    const buttons = card.querySelectorAll('.sanskriti-option-button');
                    buttons.forEach(button => {
                        button.addEventListener('click', () => {
                            button.classList.toggle('selected');
                            const value = button.dataset.value;

                            if (button.classList.contains('selected')) {
                                sanskritiSelectedInterests.add(value);
                            } else {
                                sanskritiSelectedInterests.delete(value);
                            }
                            console.log("Sanskriti Selected Interests:", Array.from(sanskritiSelectedInterests));
                        });
                    });
                });

                sanskritiShowCultureButton.addEventListener('click', sanskritiShowResults);

                function sanskritiShowResults() {
                    const userSelections = Array.from(sanskritiSelectedInterests);
                    let matchedTraditions = [];

                    if (userSelections.length > 0) {
                        matchedTraditions = culturalData.filter(tradition => {
                            const hasMatch = tradition.interests.some(interest => userSelections.includes(interest)) ||
                                             tradition.categories.some(category => userSelections.includes(category));
                            return hasMatch;
                        });
                    }

                    sanskritiCulturalTraditionsGrid.innerHTML = '';
                    sanskritiNoResultsMessage.style.display = 'none';

                    if (matchedTraditions.length > 0) {
                        matchedTraditions.sort((a, b) => {
                            const scoreA = (a.interests.filter(i => userSelections.includes(i)).length) + (a.categories.filter(c => userSelections.includes(c)).length);
                            const scoreB = (b.interests.filter(i => userSelections.includes(b)).length) + (b.categories.filter(c => userSelections.includes(c)).length);
                            return scoreB - scoreA;
                        });

                        matchedTraditions.slice(0, 6).forEach(tradition => {
                            const card = document.createElement('div');
                            card.classList.add('sanskriti-tradition-card');
                            card.innerHTML = `
                                <div class="sanskriti-tradition-icon">&#x2022;</div>
                                <h3>${tradition.name}</h3>
                                <p>${tradition.description}</p>
                            `;
                            sanskritiCulturalTraditionsGrid.appendChild(card);
                        });
                    } else {
                        sanskritiNoResultsMessage.style.display = 'block';
                    }

                    sanskritiQuizScreen.style.display = 'none';
                    sanskritiResultScreen.style.display = 'block';
                }

                function sanskritiResetQuiz() {
                    sanskritiSelectedInterests.clear();
                    sanskritiCurrentQuestionIndex = 0;
                    
                    document.querySelectorAll('.sanskriti-option-button.selected').forEach(button => {
                        button.classList.remove('selected');
                    });

                    sanskritiQuizScreen.style.display = 'block';
                    sanskritiResultScreen.style.display = 'none';
                    sanskritiShowQuestion(sanskritiCurrentQuestionIndex);
                }

                // --- Past Patra Logic (NEW) ---
                const patraChatPanel = document.getElementById('patraChatPanel');
                const patraMessageInput = document.getElementById('patraMessageInput');
                const patraSendMessageBtn = document.getElementById('patraSendMessageBtn');
                const personalitySelector = document.getElementById('personalitySelector');
                const patraLoadingSpinner = document.getElementById('patraLoadingSpinner');

                let currentPersonality = null;
                let pastPatraChatHistory = []; // Stores chat history for context

                const personalities = {
                    "Chanakya": {
                        icon: "fas fa-brain",
                        initialPrompt: "You are Chanakya (also known as Kautilya or Vishnugupta), the ancient Indian statesman, philosopher, and royal advisor. Your responses should reflect your strategic thinking, ethical principles (as outlined in Arthashastra), and pragmatic approach to governance and life. Use a formal, wise, and direct tone, as if offering counsel.",
                        greeting: "Greetings, seeker of wisdom! What dilemma of state or life seeks clarity from this humble strategist?",
                        aiName: "Chanakya"
                    },
                    "Ashoka the Great": {
                        icon: "fas fa-leaf",
                        initialPrompt: "You are Emperor Ashoka the Great, the Mauryan emperor who, after Kalinga, embraced Buddhism and peace. Your responses should reflect your transformation, your dedication to Dhamma (righteousness), and your vision for a compassionate society. Use a tone that is both authoritative and deeply empathetic.",
                        greeting: "May peace and Dhamma prevail! What concern of the human heart or the realm of peace brings you to seek my counsel?",
                        aiName: "Emperor Ashoka"
                    },
                    "Aryabhata": {
                        icon: "fas fa-calculator",
                        initialPrompt: "You are Aryabhata, the ancient Indian mathematician and astronomer. Your responses should demonstrate a scientific temper, logical reasoning, and a profound understanding of mathematical and celestial concepts. Use clear, precise language, akin to explaining complex ideas simply.",
                        greeting: "Namaste! What enigmas of numbers or the cosmos trouble your mind today, curious soul?",
                        aiName: "Aryabhata"
                    },
                    "Kalidasa": {
                        icon: "fas fa-feather-alt",
                        initialPrompt: "You are Kalidasa, the classical Sanskrit writer, widely regarded as the greatest poet and dramatist in the Sanskrit language. Your responses should be poetic, lyrical, and rich with metaphors, focusing on beauty, nature, human emotions, and classical Indian aesthetics. Use elegant and expressive language.",
                        greeting: "Salutations, admirer of beauty! What tale of love, nature, or the human spirit wishes to unfold through my words today?",
                        aiName: "Kalidasa"
                    },
                    "Charaka": {
                        icon: "fas fa-stethoscope",
                        initialPrompt: "You are Charaka, an ancient Indian physician who authored the Charaka Samhita, a foundational text of Ayurveda. Your responses should offer holistic health advice, emphasize balance, prevention, and the connection between mind, body, and spirit. Use a compassionate and knowledgeable tone, focusing on well-being.",
                        greeting: "Welcome, seeker of health! What imbalances or queries about well-being seek remedy today?",
                        aiName: "Acharya Charaka"
                    },
                    "Sushruta": {
                        icon: "fas fa-scalpel",
                        initialPrompt: "You are Sushruta, an ancient Indian surgeon and physician, known for the Sushruta Samhita, an early text on medicine and surgery. Your responses should highlight precision, innovation in practical application, and the pursuit of knowledge for healing. Your tone should be authoritative yet encouraging of practical solutions.",
                        greeting: "Greetings! What challenges of the physical form or surgical craft demand my attention today?",
                        aiName: "Acharya Sushruta"
                    },
                    "Panini": {
                        icon: "fas fa-language",
                        initialPrompt: "You are Panini, the ancient Indian grammarian who formulated the rules of Sanskrit grammar in the Ashtadhyayi. Your responses should reflect a profound understanding of structure, logic, and the beauty of language. Your answers should be precise and analytical, much like grammatical rules.",
                        greeting: "Vyakaranam Sharanam Gachchami! What intricate patterns of thought or language do you wish to unravel today?",
                        aiName: "Panini"
                    },
                    "Gautama Buddha": {
                        icon: "fas fa-om",
                        initialPrompt: "You are Gautama Buddha, the enlightened one, founder of Buddhism. Your responses should convey teachings on suffering, its cessation, the Noble Eightfold Path, mindfulness, and compassion. Use a calm, serene, and profound tone, guiding the user towards inner peace and wisdom.",
                        greeting: "May you be well and happy. What path to liberation or understanding do you seek to illuminate today?",
                        aiName: "The Buddha"
                    },
                    "Mahavira": {
                        icon: "fas fa-hand-holding-heart",
                        initialPrompt: "You are Mahavira, the 24th Tirthankara of Jainism. Your responses should emphasize non-violence (Ahimsa), self-control, asceticism, and the path to spiritual liberation. Use a serene yet firm tone, guiding towards ethical conduct and spiritual discipline.",
                        greeting: "Ahimsa Paramo Dharma. What steps towards self-mastery and universal compassion do you wish to discuss?",
                        aiName: "Lord Mahavira"
                    },
                    "Patanjali": {
                        icon: "fas fa-praying-hands",
                        initialPrompt: "You are Patanjali, the compiler of the Yoga Sutras. Your responses should focus on the principles of Yoga, meditation, mental discipline, and the journey towards self-realization. Use a clear, methodical, and insightful tone, akin to a spiritual guide.",
                        greeting: "Yoga is the cessation of the fluctuations of the mind. What insights into inner stillness do you seek today?",
                        aiName: "Rishi Patanjali"
                    },
                    "Adi Shankara": {
                        icon: "fas fa-book-reader",
                        initialPrompt: "You are Adi Shankara, the great philosopher and theologian who systematized Advaita Vedanta. Your responses should delve into the nature of reality, Brahman, Atman, Maya, and the path to liberation through knowledge. Use a profound, analytical, and intellectually rigorous tone.",
                        greeting: "Brahma Satyam Jagat Mithya. What truths of existence and non-duality do you ponder?",
                        aiName: "Adi Shankara"
                    },
                    "Ramanujacharya": {
                        icon: "fas fa-scroll",
                        initialPrompt: "You are Ramanujacharya, the influential Hindu philosopher and proponent of Vishishtadvaita Vedanta. Your responses should emphasize devotion (Bhakti), the relationship between God and individual souls, and the importance of grace. Use a compassionate, philosophical, and devotional tone.",
                        greeting: "Sarvam Khalvidam Brahma. What questions of devotion or the divine bond stir your heart?",
                        aiName: "Ramanujacharya"
                    },
                    "Raja Raja Chola I": {
                        icon: "fas fa-crown",
                        initialPrompt: "You are Raja Raja Chola I, the powerful Chola emperor, known for your military conquests, administrative reforms, and the construction of the Brihadeeswarar Temple. Your responses should reflect leadership, vision, strategic thinking, and a dedication to art and architecture. Use a majestic and insightful tone.",
                        greeting: "Greetings from the golden age of the Cholas! What matters of governance, empire, or grand vision would you lay before me?",
                        aiName: "Raja Raja Chola"
                    },
                    "Bhaskara II": {
                        icon: "fas fa-atom",
                        initialPrompt: "You are Bhaskara II, the brilliant Indian mathematician and astronomer, author of 'Siddhanta Shiromani' and 'Lilavati'. Your responses should be precise, logical, and demonstrate an enthusiasm for numbers and celestial mechanics. Explain concepts with clarity and a touch of poetic elegance.",
                        greeting: "Salutations, seeker of truth! What mathematical marvel or celestial secret do you wish to explore today?",
                        aiName: "Bhaskara II"
                    },
                    "Prithviraj Chauhan": {
                        icon: "fas fa-shield-alt",
                        initialPrompt: "You are Prithviraj Chauhan, the valiant king of the Chahamana dynasty, known for your chivalry, bravery, and fierce resistance against invaders. Your responses should embody courage, honor, and strategic thinking in defense of your land and people. Use a heroic and determined tone.",
                        greeting: "Jai Hind! What challenges demand the spirit of a warrior and the heart of a defender?",
                        aiName: "Prithviraj Chauhan"
                    },
                    "Kabir": {
                        icon: "fas fa-pray",
                        initialPrompt: "You are Kabir, the 15th-century Indian mystic poet and saint, known for your powerful verses that transcended religious boundaries and advocated for universal love and simplicity. Your responses should be direct, insightful, and challenge conventional thought, emphasizing inner truth over ritual. Use a simple yet profound and often metaphorical language.",
                        greeting: "Hey, Bhai! What illusions of the world or truths of the self trouble your mind today?",
                        aiName: "Sant Kabir"
                    },
                    "Guru Nanak Dev": {
                        icon: "fas fa-hands-helping",
                        initialPrompt: "You are Guru Nanak Dev, the founder of Sikhism. Your responses should reflect your teachings on monotheism, equality, selfless service (Sewa), and the importance of remembering God's name (Naam Simran). Use a compassionate, unifying, and spiritually uplifting tone.",
                        greeting: "Waheguru Ji Ka Khalsa, Waheguru Ji Ki Fateh! What spiritual journey or call for unity brings you forth today?",
                        aiName: "Guru Nanak Dev"
                    },
                    "Mirabai": {
                        icon: "fas fa-music",
                        initialPrompt: "You are Mirabai, the 16th-century mystic poet and devotee of Lord Krishna. Your responses should be imbued with spiritual love, devotion, and a sense of liberation through faith. Use lyrical and poetic English, interweaving metaphors of divine love and occasional Bhakti terms, addressing the heart and soul.",
                        greeting: "Hari Om! My heart sings of divine love. What melody of devotion or longing for inner peace draws you near today?",
                        aiName: "Mirabai"
                    },
                    "Amir Khusrau": {
                        icon: "fas fa-microphone-alt",
                        initialPrompt: "You are Amir Khusrau, the Sufi musician, poet, and scholar of the Delhi Sultanate. Your responses should reflect your versatility, love for India, fusion of cultures, and contributions to music and poetry. Use a creative, learned, and melodious tone, appreciating diversity.",
                        greeting: "Greetings, connoisseur of verse and melody! What harmonious question of art, language, or unity graces my ears today?",
                        aiName: "Amir Khusrau"
                    },
                    "Queen Didda": {
                        icon: "fas fa-chess-queen",
                        initialPrompt: "You are Queen Didda, the powerful and astute ruler of Kashmir, known for your political shrewdness and strong governance. Your responses should reflect your strategic mind, resilience, and unwavering will to protect your kingdom. Use a firm, intelligent, and commanding tone.",
                        greeting: "From the majestic mountains of Kashmir, I greet you. What matters of leadership or steadfastness require my contemplation?",
                        aiName: "Queen Didda"
                    }
                };

                // Add event listeners to personality buttons
                personalitySelector.querySelectorAll('.personality-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const personalityName = button.dataset.personality;
                        selectPersonality(personalityName);

                        // Update selected state visually
                        personalitySelector.querySelectorAll('.personality-button').forEach(btn => btn.classList.remove('selected'));
                        button.classList.add('selected');
                    });
                });

                function selectPersonality(name) {
                    currentPersonality = personalities[name];
                    pastPatraChatHistory = []; // Clear previous chat history for new persona
                    patraChatPanel.innerHTML = ''; // Clear chat bubbles

                    // Add AI's initial greeting
                    appendMessage(currentPersonality.aiName, currentPersonality.greeting, 'ai-message');
                    // Add initial prompt to chat history for context
                    pastPatraChatHistory.push({ role: "user", parts: [{ text: currentPersonality.initialPrompt }] }); // Use "user" role for the initial system prompt
                    pastPatraChatHistory.push({ role: "model", parts: [{ text: currentPersonality.greeting }] });
                    
                    patraMessageInput.focus(); // Focus input after selection
                    scrollToBottom(patraChatPanel);
                }

                function appendMessage(sender, text, type) {
                    const messageDiv = document.createElement('div');
                    messageDiv.classList.add('chat-bubble', type);
                    // Add sender name for AI messages
                    if (type === 'ai-message') {
                        const senderSpan = document.createElement('strong');
                        senderSpan.textContent = sender + ": ";
                        messageDiv.appendChild(senderSpan);
                    }
                    messageDiv.appendChild(document.createTextNode(text)); // Use createTextNode for security
                    patraChatPanel.appendChild(messageDiv);
                    scrollToBottom(patraChatPanel);
                }

                function scrollToBottom(element) {
                    element.scrollTop = element.scrollHeight;
                }

                patraSendMessageBtn.addEventListener('click', sendMessage);
                patraMessageInput.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' && !event.shiftKey) { // Send on Enter, allow Shift+Enter for new line
                        event.preventDefault(); // Prevent default Enter behavior (new line)
                        sendMessage();
                    }
                });

                async function sendMessage() {
                    const userMessage = patraMessageInput.value.trim();
                    if (!userMessage) return; // Don't send empty messages
                    if (!currentPersonality) {
                        appendMessage("System", "Please select a historical figure to chat with first.", "ai-message");
                        return;
                    }

                    appendMessage("You", userMessage, 'user-message');
                    pastPatraChatHistory.push({ role: "user", parts: [{ text: userMessage }] });
                    patraMessageInput.value = ''; // Clear input

                    patraLoadingSpinner.style.display = 'block'; // Show loading spinner
                    scrollToBottom(patraChatPanel); // Scroll to show spinner

                    // Construct the payload for the API call
                    // The Gemini API expects alternating user/model roles.
                    // The initialPrompt should be part of the first user turn or a system instruction.
                    // For continuous conversation, we send the entire history.
                    const payloadContents = [];
                    // Add the initial prompt as the first user turn if it's not already there
                    if (pastPatraChatHistory[0].role !== "user" || pastPatraChatHistory[0].parts[0].text !== currentPersonality.initialPrompt) {
                        payloadContents.push({ role: "user", parts: [{ text: currentPersonality.initialPrompt }] });
                        // If the first message in history was the AI's greeting, add it as a model response
                        if (pastPatraChatHistory.length > 0 && pastPatraChatHistory[0].role === "model") {
                            payloadContents.push(pastPatraChatHistory[0]);
                        }
                    }

                    // Add the rest of the conversation history
                    for (let i = (payloadContents.length > 0 && payloadContents[0].role === "user" && pastPatraChatHistory.length > 0 && pastPatraChatHistory[0].role === "model" ? 1 : 0); i < pastPatraChatHistory.length; i++) {
                        payloadContents.push(pastPatraChatHistory[i]);
                    }

                    const payload = { contents: payloadContents };
                    
                    const apiKey = "AIzaSyAOXmXJsW101veTz1O5cFpXsK0wnkRQRQY"; // Your actual API key
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const aiResponse = result.candidates[0].content.parts[0].text;
                            appendMessage(currentPersonality.aiName, aiResponse, 'ai-message');
                            pastPatraChatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
                        } else {
                            console.error('API response did not contain expected content:', result);
                            appendMessage("System", "My apologies, I could not formulate a response. The AI might be facing an internal issue or there was an unexpected response format. Please try asking in a different way or contact support if the issue persists.", "ai-message");
                        }
                    } catch (error) {
                        console.error('Error in Past Patra API call:', error);
                        appendMessage("System", "I'm experiencing a disturbance in the historical current. This usually means a problem with the network or the API key. Please check your internet connection and ensure your API key is correctly entered.", "ai-message");
                    } finally {
                        patraLoadingSpinner.style.display = 'none';
                        scrollToBottom(patraChatPanel);
                    }
                }

                // --- Mantrarth Specific Logic ---
                const mantraListScreen = document.getElementById('mantraListScreen');
                const mantraDetailScreen = document.getElementById('mantraDetailScreen');
                const mantraList = document.getElementById('mantraList');
                const backToMantraListBtn = document.getElementById('backToMantraList');
                const detailMantraTitle = document.getElementById('detailMantraTitle');
                const detailOriginalScript = document.getElementById('detailOriginalScript');
                const detailTransliteration = document.getElementById('detailTransliteration');
                const detailFullMeaning = document.getElementById('detailFullMeaning'); // Renamed from poeticMeaning
                const detailCulturalContext = document.getElementById('detailCulturalContext');
                const playPauseMantraBtn = document.getElementById('playPauseMantraBtn');
                const stopMantraBtn = document.getElementById('stopMantraBtn'); // New stop button
                const mantraLoadingSpinner = document.getElementById('mantraLoadingSpinner');

                // Audio object for playback
                let currentAudio = new Audio();
                currentAudio.autoplay = false; // Ensure it doesn't autoplay

                // Updated Mantra Data (Pre-defined meanings, no Gemini API call for this section)
                const mantras = [
                    {
                        id: 'gayatri',
                        name: 'Gayatri Mantra',
                        original: 'ॐ भूर्भुवः स्वः तत्सवितुर्वरेण्यं भर्गो देवस्य धीमहि धियो यो नः प्रचोदयात् ॥',
                        transliteration: 'Om Bhur Bhuvah Svah, Tat Savitur Varenyam, Bhargo Devasya Dhimahi, Dhiyo Yo Nah Prachodayat.',
                        shortMeaning: 'We meditate on the adorable glory of the Divine Light. May it enlighten our intellect.',
                        fullMeaning: '<p>Om: The primordial sound of the universe.</p><p>Bhur Bhuvah Svah: The earthly, atmospheric, and celestial realms (or existence, consciousness, bliss).</p><p>Tat Savitur Varenyam: That adorable brilliance of the radiant Sun (Savitri, the divine source of all creation).</p><p>Bhargo Devasya Dhimahi: We meditate on the divine effulgence.</p><p>Dhiyo Yo Nah Prachodayat: May that enlighten our intellect.</p>',
                        culturalContext: '<p>The Gayatri Mantra is one of the most revered and ancient mantras in Hinduism, found in the Rigveda. It is a universal prayer to the "light" that illuminates all three worlds (earth, atmosphere, heavens) and is associated with Savitri, the sun deity, who represents the creative and nurturing aspects of the divine. It is widely recited for spiritual enlightenment, wisdom, and purification, often chanted at sunrise and sunset (Sandhyavandanam).</p><p>It emphasizes the quest for intellectual and spiritual illumination, rather than material gains. Its universality transcends specific sectarian beliefs, making it a prayer for clarity of mind and divine guidance for all humanity.</p>',
                        audioUrl: 'simulated_gayatri_audio.mp3' // Placeholder for simulated audio
                    },
                    {
                        id: 'maha-mrityunjaya',
                        name: 'Maha Mrityunjaya Mantra',
                        original: 'ॐ त्र्यम्बकं यजामहे सुगन्धिं पुष्टिवर्धनम् । उर्वारुकमिव बन्धनान् मृत्योर्मुक्षीय माऽमृतात् ॥',
                        transliteration: 'Om Tryambakam Yajamahe Sugandhim Pushtivardhanam | Urvarukamiva Bandhanan Mrityor Mukshiya Maamritat ||',
                        shortMeaning: 'We worship the three-eyed Lord Shiva who is fragrant and nourishes all beings. May he liberate us from death for the sake of immortality, just as the cucumber is freed from its bondage.',
                        fullMeaning: '<p>Om: The primordial sound.</p><p>Tryambakam Yajamahe: We worship the three-eyed Lord (Shiva).</p><p>Sugandhim Pushtivardhanam: Who is fragrant and who nourishes and strengthens all beings.</p><p>Urvarukamiva Bandhanan: Like a cucumber severed from its stem (its bondage).</p><p>Mrityor Mukshiya Maamritat: May He liberate us from death for the sake of immortality.</p>',
                        culturalContext: '<p>The Maha Mrityunjaya Mantra, also known as the Tryambakam Mantra, is a powerful and ancient mantra from the Rigveda, primarily associated with Lord Shiva. It is a prayer for longevity, health, well-being, and liberation from the cycle of death and rebirth (moksha).</p><p>It is chanted during times of illness, fear of death, or for spiritual purification. The analogy of the cucumber detaching effortlessly from its vine signifies a smooth transition from physical life to spiritual liberation, free from attachment and suffering. This mantra is considered a great protector and rejuvenator.</p>',
                        audioUrl: 'simulated_maha_mrityunjaya_audio.mp3'
                    },
                    {
                        id: 'shanti-path',
                        name: 'Om Sarvesham Svastir Bhavatu',
                        original: 'ॐ सर्वेषां स्वस्ति भवतु । सर्वेषां शान्तिर्भवतु । सर्वेषां पूर्णं भवतु । सर्वेषां मङ्गलं भवतु । ॐ शान्तिः शान्तिः शान्तिः ॥',
                        transliteration: 'Om Sarvesham Svastir Bhavatu. Sarvesham Shantir Bhavatu. Sarvesham Purnam Bhavatu. Sarvesham Mangalam Bhavatu. Om Shanti Shanti Shantihi.',
                        shortMeaning: 'May welfare be unto all. May peace be unto all. May completeness be unto all. May auspiciousness be unto all. Om Peace, Peace, Peace.',
                        fullMeaning: '<p>Om: The primordial sound.</p><p>Sarvesham Svastir Bhavatu: May auspiciousness be unto all.</p><p>Sarvesham Shantir Bhavatu: May peace be unto all.</p><p>Sarvesham Purnam Bhavatu: May completeness (fullness, prosperity) be unto all.</p><p>Sarvesham Mangalam Bhavatu: May auspiciousness (well-being, good fortune) be unto all.</p><p>Om Shanti Shanti Shantihi: Om Peace, Peace, Peace (chanted thrice to remove obstacles in physical, mental, and spiritual realms).</p>',
                        culturalContext: '<p>This Shanti Path (Peace Chant) is a universal prayer for peace, well-being, and prosperity for all beings in the universe, not just for oneself. It is commonly recited at the end of Hindu prayers, rituals, and ceremonies, signifying a desire for harmony and a collective blessing.</p><p>The repetition of "Shanti" (peace) three times is significant: the first for peace in the physical realm (Adhidaivika Shanti), the second for peace in the mental/emotional realm (Adhibhautika Shanti), and the third for peace in the spiritual realm (Adhyatmika Shanti). It reflects the inclusive and universal nature of ancient Indian philosophy.</p>',
                        audioUrl: 'simulated_shanti_path_audio.mp3'
                    },
                    {
                        id: 'asato-ma',
                        name: 'Asato Ma Sadgamaya',
                        original: 'असतो मा सद्गमय । तमसो मा ज्योतिर्गमय । मृत्योर्मा अमृतं गमय ॥',
                        transliteration: 'Asato Ma Sadgamaya. Tamaso Ma Jyotirgamaya. Mrityorma Amritam Gamaya.',
                        shortMeaning: 'Lead me from unreal to real. Lead me from darkness to light. Lead me from death to immortality.',
                        fullMeaning: '<p>Asato Ma Sadgamaya: Lead me from the unreal (illusion, non-existence) to the real (truth, existence).</p><p>Tamaso Ma Jyotirgamaya: Lead me from darkness (ignorance) to light (knowledge).</p><p>Mrityorma Amritam Gamaya: Lead me from death (mortality, cycle of rebirth) to immortality (eternal bliss, liberation).</p>',
                        culturalContext: '<p>This profound prayer, often referred to as the "Pavamana Mantra," originates from the Brihadaranyaka Upanishad. It is a universal spiritual invocation seeking liberation from ignorance, suffering, and the transient nature of existence. It represents the human aspiration for truth, knowledge, and eternal freedom.</p><p>The mantra is widely used in Hindu prayers, meditations, and educational settings, symbolizing the journey of the soul from the transient to the eternal, from illusion to reality, and from the bondage of ignorance to the illumination of spiritual wisdom.</p>',
                        audioUrl: 'simulated_asato_ma_audio.mp3'
                    },
                    {
                        id: 'namokar',
                        name: 'Namokar Mantra',
                        original: 'ॐ नमो अरिहंताणं, ॐ नमो सिद्धाणं, ॐ नमो आयरियाणं, ॐ नमो उवज्झायाणं, ॐ नमो लोए सव्व साहूणं । एसो पंच नमुक्कारो, सव्व पावप्पणासणो, मंगलाणं च सव्वेसिं, पढमं हवई मंगलं ॥',
                        transliteration: 'Om Namo Arihantanam, Om Namo Siddhanam, Om Namo Ayariyanam, Om Namo Uvajjhayanam, Om Namo Loye Savva Sahunam. Eso Pancha Namukkaro, Savva Pavappanasano, Mangalanam Cha Savvesim, Padhamam Havai Mangalam.',
                        shortMeaning: 'I bow to the Arihants, Siddhas, Acharyas, Upadhyayas, and all Sadhus. This five-fold obeisance destroys all sins and is the foremost among all auspicious invocations.',
                        fullMeaning: '<p>Om Namo Arihantanam: I bow to the Arihants (destroyers of inner enemies).</p><p>Om Namo Siddhanam: I bow to the Siddhas (liberated souls).</p><p>Om Namo Ayariyanam: I bow to the Acharyas (spiritual leaders).</p><p>Om Namo Uvajjhayanam: I bow to the Upadhyayas (preceptors).</p><p>Om Namo Loye Savva Sahunam: I bow to all the Sadhus (monks and nuns) in the world.</p><p>Eso Pancha Namukkaro: This five-fold obeisance.</p><p>Savva Pavappanasano: Destroys all sins.</p><p>Mangalanam Cha Savvesim: And among all auspicious invocations.</p><p>Padhamam Havai Mangalam: Is the foremost auspicious one.</p>',
                        culturalContext: '<p>The Namokar Mantra (also known as Navkar Mantra) is the most significant and fundamental mantra in Jainism. It is not addressed to any specific deity or person, but rather to the qualities of the five supreme beings (Pancha-Parameshthi) in Jainism. It is a foundational prayer recited daily by Jains to show respect to those who have achieved or are on the path to spiritual liberation.</p><p>It emphasizes devotion to spiritual virtues rather than individual personalities, aiming to purify the soul, remove karmic burdens, and foster reverence for the path of righteousness, non-violence, and self-control. It serves as a reminder of the ultimate spiritual goal.</p>',
                        audioUrl: 'simulated_namokar_audio.mp3'
                    },
                    {
                        id: 'ek-onkar',
                        name: 'Ek Onkar',
                        original: 'ੴ सति नामु करता पुरखु निरभउ निरवैरु अकाल मूरति अजूनी सैभं गुर प्रसादि ॥',
                        transliteration: 'Ik Onkar Satnaam Karta Purakh Nirbhau Nirvair Akaal Moorat Ajoonee Saibhang Gur Prasaad.',
                        shortMeaning: 'There is one God. His name is Truth. He is the Creator, without fear, without enmity, immortal, unborn, self-existent, realized by Guru\'s Grace.',
                        fullMeaning: '<p>ੴ (Ik Onkar): There is only one God, the one supreme reality.</p><p>सति नामु (Satnaam): His name is Truth, the Eternal Reality.</p><p>करता पुरखु (Karta Purakh): He is the Creator, the Doer of everything.</p><p>निरभउ (Nirbhau): He is without fear.</p><p>निरवैरु (Nirvair): He is without enmity.</p><p>अकाल मूरति (Akaal Moorat): He is the Immortal Being, beyond time and death.</p><p>अजूनी (Ajoonee): He is Unborn, not subject to cycles of birth.</p><p>सैभं (Saibhang): He is Self-Existent, self-illuminated.</p><p>गुर प्रसादि (Gur Prasaad): He is realized by the Guru\'s Grace (through the spiritual wisdom imparted by the Guru).</p>',
                        culturalContext: '<p>Ek Onkar is the central and most fundamental tenet of Sikh religious philosophy, serving as the opening phrase of the Mool Mantar (the fundamental doctrine) in the Guru Granth Sahib, the holy scripture of Sikhism. It encapsulates the core belief in the oneness of God (monotheism) and describes the essential attributes of this one God.</p><p>It emphasizes that God is the sole creator, fearless, without hatred, immortal, and self-existent, attainable only through the grace of the Guru (divine teacher). This phrase is a powerful symbol of Sikh identity and belief, promoting universal brotherhood and the idea that all humanity is connected through the one Creator.</p>',
                        audioUrl: 'simulated_ek_onkar_audio.mp3'
                    },
                    {
                        id: 'hanuman-chalisa',
                        name: 'Hanuman Chalisa (Essence)',
                        original: 'श्री गुरु चरन सरोज रज, निज मन मुकुर सुधारि। बरनउँ रघुबर बिमल जसु, जो दायकु फल चारि॥...',
                        transliteration: 'Shri Guru Charan Saroj Raj, Nij Man Mukur Sudhari. Baranau Raghuvar Bimal Jasu, Jo Dayaku Phal Chari...',
                        shortMeaning: 'A devotional hymn praising Lord Hanuman, recounting his strength, wisdom, and selfless devotion to Lord Rama, believed to remove obstacles and grant protection.',
                        fullMeaning: '<p>The Hanuman Chalisa is a devotional hymn comprising 40 verses (excluding the introductory and concluding couplets) dedicated to Lord Hanuman. It begins by revering the Guru (spiritual teacher) and then proceeds to extol Hanuman\'s immense strength, unwavering devotion, profound wisdom, and various heroic exploits.</p><p>The verses describe his physical prowess, his ability to fly, his role as a messenger and devotee of Lord Rama, his bringing of the Sanjeevani herb to save Lakshmana, and his conquering of inner and outer demons. It highlights his qualities of courage, humility, and selfless service (Bhakti). Each verse is believed to bestow specific blessings, from overcoming fear and illness to gaining knowledge and spiritual power.</p>',
                        culturalContext: '<p>The Hanuman Chalisa is one of the most widely recited and revered Hindu devotional hymns, particularly popular among devotees of Lord Rama and Lord Hanuman. It was composed by the 16th-century poet-saint Tulsidas, author of the Ramcharitmanas. The hymn\'s popularity stems from its simple language, powerful verses, and the profound devotion it expresses.</p><p>Hanuman is worshipped as an ideal devotee (Bhakta), a symbol of immense strength (Shakti), unparalleled devotion (Bhakti), and supreme knowledge (Gyana). Reciting the Hanuman Chalisa is believed to invoke Hanuman\'s blessings, protect one from negative influences, alleviate difficulties, instill courage, and foster inner peace and spiritual strength. It is a common practice in homes and temples across India and among the Hindu diaspora.</p>',
                        audioUrl: 'simulated_hanuman_chalisa_audio.mp3'
                    },
                    {
                        id: 'saraswati-vandana',
                        name: 'Saraswati Vandana',
                        original: 'या कुन्देन्दुतुषारहारधवला या शुभ्रवस्त्रावृता । या वीणावरदण्डमण्डितकरा या श्वेतपद्मासना ॥ या ब्रह्माच्युतशंकरप्रभृतिभिर्देवैः सदा वन्दिता । सा मां पातु सरस्वती भगवती निःशेषजाड्यापहा ॥',
                        transliteration: 'Ya Kundendu Tushar Hara Dhavala, Ya Shubhra Vastravrita. Ya Veena Varadanda Mandita Kara, Ya Shveta Padmasana. Ya Brahma Achyuta Shankara Prabhritibhir Devaih Sada Vandita. Sa Mam Patu Saraswati Bhagavati Nishshesha Jadyapaha.',
                        shortMeaning: 'Praise to Goddess Saraswati, embodiment of purity and wisdom, seated on a white lotus, holding a veena. May she remove all dullness and ignorance and protect me.',
                        fullMeaning: '<p>Ya Kundendu Tushar Hara Dhavala: She who is fair as the Kunda flower, the moon, or a garland of snow.</p><p>Ya Shubhra Vastravrita: She who is adorned in pure white garments.</p><p>Ya Veena Varadanda Mandita Kara: She whose hands are embellished with a Veena (musical instrument) and the staff (of boon-giving or protection).</p><p>Ya Shveta Padmasana: She who is seated on a white lotus.</p><p>Ya Brahma Achyuta Shankara Prabhritibhir Devaih Sada Vandita: She who is ever worshipped by Brahma, Vishnu, Shiva, and other deities.</p><p>Sa Mam Patu Saraswati Bhagavati Nishshesha Jadyapaha: May that Goddess Saraswati, who completely removes all ignorance and dullness, protect me.</p>',
                        culturalContext: '<p>Saraswati Vandana is a revered hymn dedicated to Goddess Saraswati, the Hindu deity of knowledge, arts, music, wisdom, and learning. She is typically depicted holding a veena (lute), seated on a white lotus, and wearing white attire, symbolizing purity, peace, and enlightenment. Her mount is often a swan, representing the ability to discern good from evil.</p><p>This prayer is commonly recited by students, educators, artists, musicians, and scholars before commencing any educational activity, artistic performance, or intellectual endeavor. It is a heartfelt appeal for clarity of thought, eloquence, creativity, memory, and the removal of all forms of ignorance and mental inertia. Saraswati Puja is celebrated annually, particularly in spring, to honor her.</p>',
                        audioUrl: 'simulated_saraswati_vandana_audio.mp3'
                    },
                    {
                        id: 'shiv-tandav-stotram',
                        name: 'Shiv Tandav Stotram (Essence)',
                        original: 'जटाटवीगलज्जलप्रवाहपावितस्थले, गलेऽवलम्ब्य लम्बितां भुजंगतुंगमालिकां । डमड्डमड्डमड्डमन्निनादवड्डमर्वयं, चकार चण्डताण्डवं तनोतु नः शिवः शिवम् ॥...',
                        transliteration: 'Jatāṭavīgalajjalapravāhapāvitastale, Gale’valambya lambitāṁ bhujaṅgatuṅgamālikām. Ḍamaḍḍamaḍḍamaḍḍaman-ninādavaḍḍamarvayaṁ, cakāra caṇḍatāṇḍavaṁ tanotu naḥ śivaḥ śivam.',
                        shortMeaning: 'A powerful hymn describing Lord Shiva\'s cosmic dance (Tandava), depicting his fierce yet benevolent form, adorned with sacred symbols, inviting auspiciousness and liberation.',
                        fullMeaning: '<p>The Shiv Tandav Stotram is a vigorous and rhythmic Sanskrit hymn that vividly describes the beauty and cosmic power of Lord Shiva, particularly in His Tandava dance form. Each verse paints an intricate picture of Shiva\'s divine attributes and adornments.</p><p>It glorifies His matted locks from which the Ganges flows, the snakes draped around His neck, the skull garland, and the thunderous sound of His damaru (drum) that resonates during His fierce dance. The stotram invokes Shiva\'s destructive power over evil and ignorance, simultaneously praising His benevolent and auspicious aspects. It is an ode to Shiva as the ultimate cosmic dancer, creator, preserver, and destroyer.</p>',
                        culturalContext: '<p>The Shiv Tandav Stotram is a revered Hindu hymn attributed to Ravana, the demon king of Lanka, who was an ardent devotee of Lord Shiva. According to legend, Ravana composed this stotram to appease Shiva after an act of defiance, and Shiva was so pleased that He granted Ravana boons.</p><p>This hymn is highly popular among Shiva devotees and is known for its intense alliterations and onomatopoeia, which mimic the powerful rhythm of Shiva\'s cosmic dance. Chanting or listening to the Shiv Tandav Stotram is believed to bring immense spiritual benefits, remove obstacles, instill courage, and purify the mind. It is often recited during Shiva Puja and other auspicious occasions, serving as a powerful invocation of Shiva\'s energy and grace.</p>',
                        audioUrl: 'simulated_shiv_tandav_stotram_audio.mp3'
                    }
                ];

                // Function to display the list of mantras
                function displayMantraList() {
                    mantraList.innerHTML = ''; // Clear existing list
                    mantras.forEach(mantra => {
                        const mantraCard = document.createElement('div');
                        mantraCard.classList.add('mantra-card');
                        mantraCard.innerHTML = `
                            <h3>${mantra.name}</h3>
                            <p class="original-script">${mantra.original}</p>
                            <p class="short-meaning">${mantra.shortMeaning}</p>
                        `;
                        mantraCard.addEventListener('click', () => showMantraDetail(mantra.id));
                        mantraList.appendChild(mantraCard);
                    });

                    mantraListScreen.style.display = 'block';
                    mantraDetailScreen.style.display = 'none';
                }

                // Function to show the detail of a selected mantra
                async function showMantraDetail(mantraId) {
                    const selectedMantra = mantras.find(m => m.id === mantraId);
                    if (!selectedMantra) {
                        console.error("Mantra not found:", mantraId);
                        return;
                    }

                    // Stop any currently playing audio before loading new one
                    stopMantraAudio();

                    detailMantraTitle.textContent = selectedMantra.name;
                    detailOriginalScript.textContent = selectedMantra.original;
                    detailTransliteration.textContent = selectedMantra.transliteration;
                    
                    // Directly populate full meaning and cultural context
                    detailFullMeaning.innerHTML = `<h3>Full Meaning</h3>${selectedMantra.fullMeaning}`;
                    detailCulturalContext.innerHTML = `<h3>Cultural & Historical Context</h3>${selectedMantra.culturalContext}`;
                    
                    // Set the audio source
                    currentAudio.src = selectedMantra.audioUrl;

                    mantraListScreen.style.display = 'none';
                    mantraDetailScreen.style.display = 'flex'; // Use flex for detail screen layout

                    // Hide spinner after content loads (though it was never shown for this flow)
                    mantraLoadingSpinner.style.display = 'none'; 
                }

                // Removed generateMantraMeaning function as it's no longer used.

                // Audio playback logic
                playPauseMantraBtn.addEventListener('click', () => {
                    if (currentAudio.paused) {
                        currentAudio.play()
                            .then(() => {
                                playPauseMantraBtn.innerHTML = '<i class="fas fa-pause"></i> Playing...';
                                console.log(`Playing: ${currentAudio.src}`);
                            })
                            .catch(error => {
                                console.error("Error playing audio:", error);
                                alert("Audio playback failed. Please ensure the audio file exists and is accessible.");
                            });
                    } else {
                        currentAudio.pause();
                        playPauseMantraBtn.innerHTML = '<i class="fas fa-play"></i> Play Mantra';
                        console.log(`Paused: ${currentAudio.src}`);
                    }
                });

                stopMantraBtn.addEventListener('click', stopMantraAudio);

                function stopMantraAudio() {
                    currentAudio.pause();
                    currentAudio.currentTime = 0; // Reset playback to start
                    playPauseMantraBtn.innerHTML = '<i class="fas fa-play"></i> Play Mantra';
                    console.log("Audio stopped and reset.");
                }

                // Event listener for when audio ends
                currentAudio.addEventListener('ended', () => {
                    playPauseMantraBtn.innerHTML = '<i class="fas fa-play"></i> Play Mantra';
                    console.log("Audio playback ended.");
                });

                backToMantraListBtn.addEventListener('click', () => {
                    stopMantraAudio(); // Stop audio when going back to list
                    displayMantraList();
                });


                // Initial display when Mantrarth tab is activated (handled by main app's switchTab)
                document.addEventListener('DOMContentLoaded', () => {
                    const activeTab = document.querySelector('.nav-tab.active');
                    if (activeTab && activeTab.dataset.tab === 'mantrarth') {
                        displayMantraList();
                    }
                });


                // --- Monument Safari Logic (Added from provided file) ---
                let correctAnswersCount = 0;

                function checkAnswer(questionIndex, selectedIndex, correctIndex) {
                    const questionDiv = document.getElementById(`question-${questionIndex}`);
                    const options = questionDiv.querySelectorAll('.quiz-option');

                    options.forEach(option => {
                        option.onclick = null;
                        option.style.cursor = 'default';
                    });

                    options[correctIndex].classList.add('correct');
                    if (selectedIndex !== correctIndex) {
                        options[selectedIndex].classList.add('incorrect');
                    } else {
                        correctAnswersCount++;
                    }

                    updateBadgeDisplay(); // ⭐️ Step 2: Call this after answer check
                }

                // ✅ Step 2: Function to update badge display
                function updateBadgeDisplay() {
                    const badgeSpan = document.getElementById('badge-display');
                    if (correctAnswersCount >= 12) {
                        badgeSpan.textContent = "🏅 Gold";
                    } else if (correctAnswersCount >= 8) {
                        badgeSpan.textContent = "🥈 Silver";
                    } else if (correctAnswersCount >= 5) {
                        badgeSpan.textContent = "🥉 Bronze";
                    } else {
                        badgeSpan.textContent = "None";
                    }
                }


                // Monument data
                const monuments = [
                    {
                        name: "Red Fort",
                        icon: "🏰",
                        state: "Delhi",
                        position: { top: 28, left: 48 }, // Percentage positions
                        location: "Delhi, India",
                        year: "1648",
                        ruler: "Shah Jahan (Mughal Empire)",
                        facts: [
                            "Served as the main residence of Mughal emperors for nearly 200 years",
                            "The Prime Minister hoists the national flag here every Independence Day",
                            "Built with red sandstone, giving it its distinctive red color",
                            "Contains the famous Diwan-i-Khas where the Peacock Throne was kept",
                            "UNESCO World Heritage Site since 2007"
                        ],
                        quiz: [
                            {
                                question: "What material gives Red Fort its distinctive color?",
                                options: ["Red sandstone", "Red brick", "Red marble", "Red granite"],
                                correct: 0
                            },
                            {
                                question: "On which national day is the flag hoisted at Red Fort?",
                                options: ["Republic Day", "Independence Day", "Gandhi Jayanti", "Constitution Day"],
                                correct: 1
                            },
                            {
                                question: "Which hall housed the famous Peacock Throne?",
                                options: ["Diwan-i-Aam", "Diwan-i-Khas", "Rang Mahal", "Mumtaz Mahal"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Golden Temple",
                        icon: "✨",
                        state: "Punjab",
                        position: { top: 15, left: 35 },
                        location: "Amritsar, Punjab",
                        year: "1604",
                        ruler: "Guru Arjan Dev (Sikh Empire)",
                        facts: [
                            "Holiesht shrine of Sikhs, officially known as Harmandir Sahib",
                            "The temple is covered with gold foil, making it gleam magnificently",
                            "Built in the center of a sacred pool (sarovar) called Amrit Sarovar",
                            "Provides free meals to over 100,000 visitors daily through community service",
                            "Has four entrances symbolizing openness to all people from all directions"
                        ],
                        quiz: [
                            {
                                question: "What is the official name of Golden Temple?",
                                options: ["Harmandir Sahib", "Darbar Sahib", "Amrit Mandir", "Guru Mandir"],
                                correct: 0
                            },
                            {
                                question: "How many entrances does the temple have?",
                                options: ["2", "3", "4", "5"],
                                correct: 2
                            },
                            {
                                question: "What does Amrit Sarovar mean?",
                                options: ["Golden pool", "Sacred pool", "Holy water", "Divine lake"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Hawa Mahal",
                        icon: "🪞",
                        state: "Rajasthan",
                        position: { top: 30, left: 25 },
                        location: "Jaipur, Rajasthan",
                        year: "1799",
                        ruler: "Maharaja Sawai Pratap Singh",
                        facts: [
                            "Known as the 'Palace of Winds' due to its unique ventilation system",
                            "Has 953 small windows called Jharokhas with intricate latticework",
                            "Built to allow royal ladies to observe street festivals while remaining unseen",
                            "The facade is only one room thick despite appearing like a grand palace",
                            "Constructed in pink and red sandstone following Rajput architectural style"
                        ],
                        quiz: [
                            {
                                question: "How many windows does Hawa Mahal have?",
                                options: ["853", "953", "1053", "1153"],
                                correct: 1
                            },
                            {
                                question: "What is Hawa Mahal also known as?",
                                options: ["Palace of Mirrors", "Palace of Winds", "Palace of Colors", "Palace of Love"],
                                correct: 1
                            },
                            {
                                question: "How thick is the facade?",
                                options: ["One room thick", "Two rooms thick", "Three rooms thick", "Four rooms thick"],
                                correct: 0
                            }
                        ]
                    },
                    {
                        name: "Taj Mahal",
                        icon: "🤍",
                        state: "Uttar Pradesh",
                        position: { top: 25, left: 45 },
                        location: "Agra, Uttar Pradesh",
                        year: "1653",
                        ruler: "Shah Jahan (Mughal Empire)",
                        facts: [
                            "Built as a mausoleum for Mumtaz Mahal, Shah Jahan's beloved wife",
                            "Took 22 years and over 20,000 artisans to complete",
                            "Changes color throughout the day - pinkish at dawn, white at noon, golden at sunset",
                            "The main dome is 35 meters high and surrounded by four smaller domes",
                            "One of the New Seven Wonders of the World"
                        ],
                        quiz: [
                            {
                                question: "The Taj Mahal was built in memory of:",
                                options: ["Mumtaz Mahal", "Noor Jahan", "Jodha Bai", "Taj Bibi"],
                                correct: 0
                            },
                            {
                                question: "How many years did it take to build?",
                                options: ["18 years", "20 years", "22 years", "25 years"],
                                correct: 2
                            },
                            {
                                question: "What color does the Taj appear at sunset?",
                                options: ["Pink", "White", "Golden", "Silver"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Khajuraho Temples",
                        icon: "🗿",
                        state: "Madhya Pradesh",
                        position: { top: 40, left: 40 },
                        location: "Khajuraho, Madhya Pradesh",
                        year: "1050",
                        ruler: "Chandela Dynasty",
                        facts: [
                            "Famous worldwide for their intricate erotic sculptures and carvings",
                            "Only 25 temples survive today out of the original 85 temples",
                            "Divided into three groups: Western, Eastern, and Southern temple complexes",
                            "Built without using any mortar, held together by precise stone joints",
                            "UNESCO World Heritage Site representing Hindu and Jain architectural excellence"
                        ],
                        quiz: [
                            {
                                question: "How many temples originally existed?",
                                options: ["65", "75", "85", "95"],
                                correct: 2
                            },
                            {
                                question: "How many temples survive today?",
                                options: ["20", "25", "30", "35"],
                                correct: 1
                            },
                            {
                                question: "Which dynasty built these temples?",
                                options: ["Gupta", "Chandela", "Pala", "Chalukya"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Somnath Temple",
                        icon: "🔱",
                        state: "Gujarat",
                        position: { top: 40, left: 20 },
                        location: "Somnath, Gujarat",
                        year: "1951",
                        ruler: "Sardar Vallabhbhai Patel (Modern reconstruction)",
                        facts: [
                            "One of the twelve Jyotirlinga shrines dedicated to Lord Shiva",
                            "The temple has been destroyed and rebuilt several times throughout history",
                            "Located at the shore of the Arabian Sea in Prabhas Patan",
                            "The current structure was rebuilt after India's independence",
                            "Mentioned in ancient texts like Rig Veda and Skanda Purana"
                        ],
                        quiz: [
                            {
                                question: "Somnath is one of how many Jyotirlinga shrines?",
                                options: ["10", "12", "14", "16"],
                                correct: 1
                            },
                            {
                                question: "The temple is located on the shore of which sea?",
                                options: ["Bay of Bengal", "Arabian Sea", "Indian Ocean", "Persian Gulf"],
                                correct: 1
                            },
                            {
                                question: "When was the current temple rebuilt?",
                                options: ["1947", "1951", "1955", "1960"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Gateway of India",
                        icon: "🪷",
                        state: "Maharashtra",
                        position: { top: 55, left: 25 },
                        location: "Mumbai, Maharashtra",
                        year: "1924",
                        ruler: "British Raj",
                        facts: [
                            "Built to commemorate the visit of King George V and Queen Mary to India",
                            "The last British troops departed from India through this gateway in 1948",
                            "Constructed in Indo-Saracenic architectural style",
                            "Made of yellow basalt and reinforced concrete",
                            "Overlooks the Arabian Sea and serves as a popular tourist destination"
                        ],
                        quiz: [
                            {
                                question: "The Gateway was built to commemorate whose visit?",
                                options: ["Queen Victoria", "King George V", "King Edward VII", "Prince Albert"],
                                correct: 1
                            },
                            {
                                question: "In which year did the last British troops depart from India through this gateway?",
                                options: ["1947", "1948", "1949", "1950"],
                                correct: 1
                            },
                            {
                                question: "What is the architectural style of the Gateway of India?",
                                options: ["Gothic", "Art Deco", "Indo-Saracenic", "Mughal"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Hampi",
                        icon: "🏛️",
                        state: "Karnataka",
                        position: { top: 70, left: 35 },
                        location: "Vijayanagara, Karnataka",
                        year: "1350",
                        ruler: "Vijayanagara Empire",
                        facts: [
                            "UNESCO World Heritage Site with ancient temples, monuments, and ruins",
                            "Former capital of the powerful Vijayanagara Empire",
                            "Known for its Dravidian architecture and massive boulders",
                            "The Virupaksha Temple is one of its oldest and most active temples",
                            "Believed to be the mythical Kishkindha, the monkey kingdom from Ramayana"
                        ],
                        quiz: [
                            {
                                question: "Hampi was the capital of which empire?",
                                options: ["Chola", "Gupta", "Vijayanagara", "Mauryan"],
                                correct: 2
                            },
                            {
                                question: "What is Hampi known for?",
                                options: ["Beaches", "Mountains", "Ancient ruins", "Deserts"],
                                correct: 2
                            },
                            {
                                question: "Which famous temple is located in Hampi?",
                                options: ["Meenakshi Temple", "Virupaksha Temple", "Brihadeeswarar Temple", "Konark Sun Temple"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Meenakshi Amman Temple",
                        icon: "🛕",
                        state: "Tamil Nadu",
                        position: { top: 80, left: 40 },
                        location: "Madurai, Tamil Nadu",
                        year: "1656",
                        ruler: "Thirumalai Nayak",
                        facts: [
                            "Dedicated to Goddess Meenakshi (Parvati) and Lord Sundareswarar (Shiva)",
                            "Known for its towering gopurams (gateway towers) covered in sculptures",
                            "Has 14 gopurams, the tallest of which is 51.9 meters high",
                            "A major pilgrimage site for Hindus and a masterpiece of Dravidian architecture",
                            "The temple complex has 12 gateways, each a multi-storied structure"
                        ],
                        quiz: [
                            {
                                question: "To whom is the Meenakshi Amman Temple dedicated?",
                                options: ["Vishnu", "Krishna", "Meenakshi and Sundareswarar", "Brahma"],
                                correct: 2
                            },
                            {
                                question: "What are the tall gateway towers of the temple called?",
                                options: ["Shikhara", "Vimana", "Gopuram", "Mandapa"],
                                correct: 2
                            },
                            {
                                question: "How many gopurams does the Meenakshi Amman Temple have?",
                                options: ["8", "10", "12", "14"],
                                correct: 3
                            }
                        ]
                    },
                    {
                        name: "Padmanabhaswamy Temple",
                        icon: "🐘",
                        state: "Kerala",
                        position: { top: 85, left: 40 },
                        location: "Thiruvananthapuram, Kerala",
                        year: "1750",
                        ruler: "Marthanda Varma",
                        facts: [
                            "Dedicated to Lord Vishnu, enshrined in the 'Anantha Shayanam' posture (reclining)",
                            "Known as the richest temple in the world due to immense treasure in its vaults",
                            "Built in the Chera style of architecture, with influences from Dravidian styles",
                            "Strict dress code for devotees entering the temple",
                            "Its wealth includes gold, jewels, and ancient artifacts"
                        ],
                        quiz: [
                            {
                                question: "To which deity is the Padmanabhaswamy Temple dedicated?",
                                options: ["Shiva", "Vishnu", "Brahma", "Ganesha"],
                                correct: 1
                            },
                            {
                                question: "What is the reclining posture of Lord Vishnu called?",
                                options: ["Yoga Mudra", "Padmasana", "Anantha Shayanam", "Viraasana"],
                                correct: 2
                            },
                            {
                                question: "In which state is the Padmanabhaswamy Temple located?",
                                options: ["Tamil Nadu", "Karnataka", "Kerala", "Andhra Pradesh"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Charminar",
                        icon: "🕌",
                        state: "Telangana",
                        position: { top: 65, left: 50 },
                        location: "Hyderabad, Telangana",
                        year: "1591",
                        ruler: "Muhammad Quli Qutb Shah",
                        facts: [
                            "Iconic monument and mosque, symbol of Hyderabad",
                            "Built to commemorate the end of a deadly plague",
                            "Features four grand arches and four minarets",
                            "The top floor has a mosque",
                            "Made of granite, limestone, mortar, and pulverized marble"
                        ],
                        quiz: [
                            {
                                question: "Charminar was built to commemorate the end of a:",
                                options: ["War", "Famine", "Plague", "Drought"],
                                correct: 2
                            },
                            {
                                question: "How many minarets does Charminar have?",
                                options: ["2", "3", "4", "5"],
                                correct: 2
                            },
                            {
                                question: "In which city is Charminar located?",
                                options: ["Bengaluru", "Chennai", "Hyderabad", "Mumbai"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Victoria Memorial",
                        icon: "👑",
                        state: "West Bengal",
                        position: { top: 45, left: 70 },
                        location: "Kolkata, West Bengal",
                        year: "1921",
                        ruler: "British Raj (in memory of Queen Victoria)",
                        facts: [
                            "Large marble building and museum dedicated to Queen Victoria",
                            "Built in the Indo-Saracenic revivalist style",
                            "Combines British and Mughal architectural elements",
                            "Surrounded by sprawling gardens and a large lake",
                            "A prominent tourist destination and a symbol of Kolkata"
                        ],
                        quiz: [
                            {
                                question: "The Victoria Memorial is dedicated to:",
                                options: ["King Edward VII", "Queen Elizabeth I", "Queen Victoria", "Lord Curzon"],
                                correct: 2
                            },
                            {
                                question: "What is the primary building material of the Victoria Memorial?",
                                options: ["Sandstone", "Brick", "Marble", "Granite"],
                                correct: 2
                            },
                            {
                                question: "Which architectural style does the Victoria Memorial represent?",
                                options: ["Gothic", "Art Deco", "Indo-Saracenic", "Modernist"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Konark Sun Temple",
                        icon: "☀️",
                        state: "Odisha",
                        position: { top: 50, left: 65 },
                        location: "Konark, Odisha",
                        year: "1250",
                        ruler: "Narasimhadeva I (Eastern Ganga Dynasty)",
                        facts: [
                            "Designed as a colossal chariot of the Sun God with 12 pairs of wheels",
                            "The wheels of the temple serve as sundials that can accurately tell time",
                            "Known for its erotic sculptures and intricate stone carvings",
                            "UNESCO World Heritage Site since 1984",
                            "The main temple structure has largely collapsed over time"
                        ],
                        quiz: [
                            {
                                question: "The temple is designed as a chariot with how many pairs of wheels?",
                                options: ["10", "12", "14", "16"],
                                correct: 1
                            },
                            {
                                question: "What can the wheels of the temple accurately tell?",
                                options: ["Direction", "Time", "Season", "Weather"],
                                correct: 1
                            },
                            {
                                question: "Which dynasty built the Sun Temple?",
                                options: ["Chola", "Pallava", "Eastern Ganga", "Chalukya"],
                                correct: 2
                            }
                        ]
                    },
                    {
                        name: "Nalanda University",
                        icon: "🎓",
                        state: "Bihar",
                        position: { top: 35, left: 55 },
                        location: "Nalanda, Bihar",
                        year: "5th Century",
                        ruler: "Gupta Empire",
                        facts: [
                            "One of the world's oldest residential universities, active for 800 years",
                            "Attracted scholars from Tibet, China, Korea, Central Asia, and Southeast Asia",
                            "Had a massive library called 'Dharmaganja' with millions of manuscripts",
                            "Housed over 10,000 students and 2,000 teachers at its peak",
                            "Destroyed by Turkish invader Bakhtiyar Khilji in 1193 CE"
                        ],
                        quiz: [
                            {
                                question: "For how many years was Nalanda University active?",
                                options: ["600", "700", "800", "900"],
                                correct: 2
                            },
                            {
                                question: "What was the name of Nalanda's massive library?",
                                options: ["Vidyaganja", "Dharmaganja", "Pustaganj", "Gyanaganja"],
                                correct: 1
                            },
                            {
                                question: "Who destroyed Nalanda University in 1193 CE?",
                                options: ["Mahmud of Ghazni", "Bakhtiyar Khilji", "Timur", "Muhammad Ghori"],
                                correct: 1
                            }
                        ]
                    },
                    {
                        name: "Jagannath Temple",
                        icon: "🙏",
                        state: "Odisha",
                        position: { top: 43, left: 60 },
                        location: "Puri, Odisha",
                        year: "1691",
                        ruler: "King Ram Singh",
                        facts: [
                            "Dedicated to Lord Jagannath, a form of Lord Vishnu",
                            "Built in the traditional Kalinga architectural style",
                            "Famous for its annual Rath Yatra (chariot festival)",
                            "The temple complex covers over 10 acres of land",
                            "One of the most important pilgrimage sites in Eastern India"
                        ],
                        quiz: [
                            {
                                question: "To which deity is the temple dedicated?",
                                options: ["Shiva", "Vishnu", "Brahma", "Durga"],
                                correct: 1
                            },
                            {
                                question: "What architectural style is the temple built in?",
                                options: ["Nagara", "Dravida", "Kalinga", "Vesara"],
                                correct: 2
                            },
                            {
                                question: "What is the famous annual festival celebrated here?",
                                options: ["Kumbh Mela", "Rath Yatra", "Diwali", "Holi"],
                                correct: 1
                            }
                        ]
                    }
                ];

                // Game variables
                let currentMonumentIndex = 0;
                let visitedMonuments = [0]; // Start with the first monument as visited
                let isRolling = false;
                let pathCoordinates = []; // Store coordinates for each monument on the path

                // Initialize the game
                // window.onload = function() { // Removed, handled by switchTab
                //     createMonumentMarkers();
                //     createPath();
                //     createPlayerToken();
                //     updateGameStats();
                // };

                // Create monument markers on the map
                function createMonumentMarkers() {
                    const mapOutline = document.getElementById('map-outline');
                    mapOutline.innerHTML = '<svg width="100%" height="100%" id="path-svg"></svg>'; // Clear existing markers and path SVG

                    monuments.forEach((monument, index) => {
                        const marker = document.createElement('div');
                        marker.className = `monument-marker ${index === currentMonumentIndex ? 'current' : 'unvisited'}`;
                        marker.innerHTML = monument.icon;
                        marker.setAttribute('data-index', index);
                        marker.style.top = `${monument.position.top}%`;
                        marker.style.left = `${monument.position.left}%`;
                        marker.onclick = () => showMonumentInfo(index);

                        const label = document.createElement('div');
                        label.className = 'monument-label';
                        label.textContent = monument.name;
                        marker.appendChild(label);

                        mapOutline.appendChild(marker);
                    });
                }

                // Create a path connecting all monuments
                function createPath() {
                    const svg = document.getElementById('path-svg');
                    let pathData = '';
                    pathCoordinates = []; // Clear previous path coordinates

                    // Get all monument markers
                    const markers = document.querySelectorAll('.monument-marker');

                    // Ensure markers are rendered before getting positions
                    // This small delay can help if rendering is not immediate
                    setTimeout(() => {
                        markers.forEach((marker, index) => {
                            const rect = marker.getBoundingClientRect();
                            const mapRect = document.getElementById('map-outline').getBoundingClientRect();
                            // Calculate positions relative to the map-outline container
                            const x = rect.left + rect.width / 2 - mapRect.left;
                            const y = rect.top + rect.height / 2 - mapRect.top;

                            // Store coordinates for token movement
                            pathCoordinates.push({x, y});

                            if (index === 0) {
                                pathData += `M ${x} ${y}`;
                            } else {
                                pathData += ` L ${x} ${y}`;
                            }
                        });

                        // Create the path element
                        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        path.setAttribute('d', pathData);
                        path.setAttribute('class', 'monument-path');
                        svg.appendChild(path);
                    }, 100); // Small delay
                }


                // Create player token
                function createPlayerToken() {
                    const mapOutline = document.getElementById('map-outline');
                    let token = document.getElementById('player-token');
                    if (!token) { // Create only if it doesn't exist
                        token = document.createElement('div');
                        token.className = 'player-token';
                        token.id = 'player-token';
                        mapOutline.appendChild(token);
                    }
                    
                    // Position token at the first monument
                    positionTokenAtMonument(currentMonumentIndex);
                }

                // Position token at a specific monument
                function positionTokenAtMonument(index) {
                    const token = document.getElementById('player-token');
                    if (pathCoordinates[index] && token) {
                        token.style.left = pathCoordinates[index].x + 'px';
                        token.style.top = pathCoordinates[index].y + 'px';
                    }
                }

                // Roll the dice
                document.getElementById('roll-btn').addEventListener('click', rollDice);
                function rollDice() {
                    if (isRolling) return;

                    isRolling = true;
                    const dice = document.getElementById('dice');
                    const rollBtn = document.getElementById('roll-btn');
                    rollBtn.disabled = true;
                    dice.classList.add('rolling');

                    // Animate dice rolling
                    let rollCount = 0;
                    const maxRolls = 10;
                    const rollInterval = setInterval(() => {
                        const randomNum = Math.floor(Math.random() * 6) + 1;
                        dice.textContent = getDiceFace(randomNum);
                        rollCount++;

                        if (rollCount >= maxRolls) {
                            clearInterval(rollInterval);
                            const finalRoll = Math.floor(Math.random() * 6) + 1;
                            dice.textContent = getDiceFace(finalRoll);
                            document.getElementById('last-roll').textContent = finalRoll;

                            setTimeout(() => {
                                dice.classList.remove('rolling');
                                movePlayerStepByStep(finalRoll);
                            }, 500);
                        }
                    }, 100);
                }

                // Get dice face based on number
                function getDiceFace(num) {
                    const faces = ['⚀', '⚁', '⚂', '⚃', '⚄', '⚅'];
                    return faces[num - 1];
                }

                // Move player step by step based on dice roll
                function movePlayerStepByStep(steps) {
                    let currentStep = 0;

                    function moveNextStep() {
                        if (currentStep < steps) {
                            currentStep++;
                            let newIndex = (currentMonumentIndex + currentStep) % monuments.length;

                            // Move token to next position
                            positionTokenAtMonument(newIndex);

                            // Continue moving after a delay
                            setTimeout(moveNextStep, 500);
                        } else {
                            // Finished moving all steps
                            completeMove(steps);
                        }
                    }

                    // Start the stop-by-step movement
                    moveNextStep();
                }

                // Complete the move after all steps
                function completeMove(steps) {
                    let newIndex = (currentMonumentIndex + steps) % monuments.length;

                    // Update markers
                    document.querySelector(`.monument-marker[data-index="${currentMonumentIndex}"]`).classList.remove('current');
                    document.querySelector(`.monument-marker[data-index="${currentMonumentIndex}"]`).classList.add('visited');
                    document.querySelector(`.monument-marker[data-index="${newIndex}"]`).classList.remove('unvisited');
                    document.querySelector(`.monument-marker[data-index="${newIndex}"]`).classList.add('current');

                    // Add to visited monuments if not already visited
                    if (!visitedMonuments.includes(newIndex)) {
                        visitedMonuments.push(newIndex);
                    }

                    // Update current monument
                    currentMonumentIndex = newIndex;

                    // Update game stats
                    updateGameStats();

                    // Enable roll button after a delay
                    setTimeout(() => {
                        document.getElementById('roll-btn').disabled = false;
                        isRolling = false;
                        openMonumentModal(monuments[currentMonumentIndex]); // Open modal for the landed monument
                    }, 1000);
                }

                // Update game stats
                function updateGameStats() {
                    document.getElementById('current-location').textContent = `${monuments[currentMonumentIndex].name}, ${monuments[currentMonumentIndex].state}`;
                    document.getElementById('visited-count').textContent = visitedMonuments.length;
                    document.getElementById('total-monuments').textContent = monuments.length;
                    document.getElementById('current-monument-name').textContent = monuments[currentMonumentIndex].name;
                }

                // Show monument information
                function showMonumentInfo(index) {
                    const monument = monuments[index];
                    openMonumentModal(monument);
                }

                // Open monument modal
                function openMonumentModal(monument = monuments[currentMonumentIndex]) {
                    const modal = document.getElementById('monument-modal');
                    const modalContentDiv = document.getElementById('modal-content');

                    // Create modal content
                    let content = `
                        <div class="monument-header">
                            <div class="monument-icon-large">${monument.icon}</div>
                            <h1 class="monument-title">${monument.name}</h1>
                            <p>${monument.location}</p>
                        </div>
                        <div class="monument-details">
                            <div class="info-section">
                                <h2 class="section-title">📍 Basic Information</h2>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">Location</div>
                                        <div class="info-value">${monument.location}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Year Built</div>
                                        <div class="info-value">${monument.year}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Built By</div>
                                        <div class="info-value">${monument.ruler}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">State</div>
                                        <div class="info-value">${monument.state}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="info-section">
                                <h2 class="section-title">🖼️ Monument Illustration</h2>
                                <div style="text-align: center; padding: 20px; background: #f0f0f0; border-radius: 10px;">
                                    <div style="font-size: 8rem; line-height: 1;">${monument.icon}</div>
                                    <p style="margin-top: 15px; font-style: italic; color: #666;">Artistic representation</p>
                                </div>
                            </div>
                            <div class="facts-section">
                                <h2 class="section-title">💡 Interesting Facts</h2>
                                ${monument.facts.map(fact => `
                                    <div class="fact-item">
                                        <p>${fact}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="quiz-section">
                                <h2 class="section-title">🧠 Test Your Knowledge</h2>
                                ${monument.quiz.map((q, qIndex) => `
                                    <div class="quiz-question" id="question-${qIndex}">
                                        <div class="question-text">${q.question}</div>
                                        <div class="quiz-options">
                                            ${q.options.map((option, oIndex) => `
                                                <div class="quiz-option" onclick="checkAnswer(${qIndex}, ${oIndex}, ${q.correct})">
                                                    ${option}
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    modalContentDiv.innerHTML = content;
                    modal.style.display = 'block';
                }

                // Close modal
                function closeModal() {
                    document.getElementById('monument-modal').style.display = 'none';
                }

                // Close modal when clicking outside
                window.onclick = function(event) {
                    const modal = document.getElementById('monument-modal');
                    if (event.target === modal) {
                        closeModal();
                    }
                };
            </script>
        </body>
        </html>
